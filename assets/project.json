{"targets":[{"isStage":true,"name":"Stage","variables":{"%PW5e$t0ohXOqyC0E~$E":["Body Color",0],"]tJ;j{`j-u~U+HM|-OP*":["Body Contrast",85],"5xsG=$qKr=H?9%|qF!.#":["Eyes Color",0],"8L,1TkQ}:c)~*EN{ab{V":["Eyes Contrast",100],"e~-{jKg0MfS`d%e1K{@z":["Pupil Color",0],"Wma,x#poLj.05w6_Foa=":["Pupil Contrast",100],"Gi!J}=Ef+H,u%{#xi^Wp":["Body Brightness",0],"@p7@CtPn%UpPY-BD6-j!":["Pupil Brightness",0],"C)E0V%|Q^1xT,DIzc%O:":["Eyes Brightness",0],"|n7veW$La9hD@l|k,gQ^":["Background Color",0],"L=zp+?]p`L|-6%%I5}Vq":["ResetConfirm?",0],"HCc`51#mPpGzbD8Mn,T9":["LightShow",0]},"lists":{},"broadcasts":{"Rf/QkD7[`*7*?(?z-=xt":"FlipEyes","vP7~JUc;bMPval3NJGSR":"Reset","Vy~T-^:%qk]4|13E$%Rl":"ResetCancel",",yk.a_pgk)TzdSKaFx1`":"Randomize","5_i$-ayXxV$P1l4C*-A_":"RandomizePupils","GBB9B^vsI`0RYu{,dnz?":"LightShow"},"blocks":{"ba":{"opcode":"event_whenflagclicked","next":"/","parent":null,"inputs":{},"fields":{},"topLevel":true},"/":{"opcode":"data_setvariableto","next":":","parent":"ba","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["ResetConfirm?","L=zp+?]p`L|-6%%I5}Vq"]}},":":{"opcode":"data_setvariableto","next":";","parent":"/","inputs":{"VALUE":[1,[10,"85"]]},"fields":{"VARIABLE":["Body Contrast","]tJ;j{`j-u~U+HM|-OP*"]}},";":{"opcode":"data_setvariableto","next":"=","parent":":","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["Body Color","%PW5e$t0ohXOqyC0E~$E"]}},"=":{"opcode":"data_setvariableto","next":"?","parent":";","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["Eyes Color","5xsG=$qKr=H?9%|qF!.#"]}},"?":{"opcode":"data_setvariableto","next":"@","parent":"=","inputs":{"VALUE":[1,[10,"100"]]},"fields":{"VARIABLE":["Eyes Contrast","8L,1TkQ}:c)~*EN{ab{V"]}},"@":{"opcode":"data_setvariableto","next":"[","parent":"?","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["Pupil Color","e~-{jKg0MfS`d%e1K{@z"]}},"[":{"opcode":"data_setvariableto","next":"]","parent":"@","inputs":{"VALUE":[1,[10,"100"]]},"fields":{"VARIABLE":["Pupil Contrast","Wma,x#poLj.05w6_Foa="]}},"]":{"opcode":"data_setvariableto","next":"^","parent":"[","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["Body Brightness","Gi!J}=Ef+H,u%{#xi^Wp"]}},"^":{"opcode":"data_setvariableto","next":"_","parent":"]","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["Pupil Brightness","@p7@CtPn%UpPY-BD6-j!"]}},"_":{"opcode":"data_setvariableto","next":"`","parent":"^","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["Eyes Brightness","C)E0V%|Q^1xT,DIzc%O:"]}},"`":{"opcode":"data_setvariableto","next":"bb","parent":"_","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["Background Color","|n7veW$La9hD@l|k,gQ^"]}},"bc":{"opcode":"event_whenflagclicked","next":"k","parent":null,"inputs":{},"fields":{},"topLevel":true},"k":{"opcode":"shovelcss_changecss","next":"b","parent":"bc","inputs":{"COLORABLE":[1,"bd"],"COLOR":[1,[9,"#ffffff"]]},"fields":{}},"bd":{"opcode":"shovelcss_menu_COLORABLE_MENU","next":null,"parent":"k","inputs":{},"fields":{"COLORABLE_MENU":["monitor text",null]},"shadow":true},"b":{"opcode":"shovelcss_changecss","next":"{","parent":"k","inputs":{"COLORABLE":[1,"be"],"COLOR":[3,"bf",[9,"#ff0000"]]},"fields":{}},"be":{"opcode":"shovelcss_menu_COLORABLE_MENU","next":null,"parent":"b","inputs":{},"fields":{"COLORABLE_MENU":["monitor background",null]},"shadow":true},"bf":{"opcode":"shovelcss_gradientAngle","next":null,"parent":"b","inputs":{"COLOR1":[1,[9,"#380fc3"]],"COLOR2":[1,[9,"#967de3"]],"ANGLE":[1,[8,"90"]]},"fields":{}},"{":{"opcode":"shovelcss_changecss","next":null,"parent":"b","inputs":{"COLORABLE":[1,"bg"],"COLOR":[1,[9,"#22097b"]]},"fields":{}},"bg":{"opcode":"shovelcss_menu_COLORABLE_MENU","next":null,"parent":"{","inputs":{},"fields":{"COLORABLE_MENU":["variable value background",null]},"shadow":true},"bh":{"opcode":"event_whenflagclicked","next":"|","parent":null,"inputs":{},"fields":{},"topLevel":true},"|":{"opcode":"control_forever","next":null,"parent":"bh","inputs":{"SUBSTACK":[2,"l"]},"fields":{}},"m":{"opcode":"sound_playuntildone","next":null,"parent":"l","inputs":{"SOUND_MENU":[3,"bi","bj"]},"fields":{}},"bi":{"opcode":"operator_random","next":null,"parent":"m","inputs":{"FROM":[1,[4,"1"]],"TO":[1,[4,"2"]]},"fields":{}},"bj":{"opcode":"sound_sounds_menu","next":null,"parent":"m","inputs":{},"fields":{"SOUND_MENU":["SpeedChuzzle",null]},"shadow":true},"bk":{"opcode":"event_whenflagclicked","next":"}","parent":null,"inputs":{},"fields":{},"topLevel":true},"}":{"opcode":"control_forever","next":null,"parent":"bk","inputs":{"SUBSTACK":[2,"bl"]},"fields":{}},"bl":{"opcode":"looks_seteffectto","next":null,"parent":"}","inputs":{"VALUE":[3,[12,"Background Color","|n7veW$La9hD@l|k,gQ^"],[4,"0"]]},"fields":{"EFFECT":["COLOR",null]}},"bm":{"opcode":"event_whenbroadcastreceived","next":"n","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["Randomize",",yk.a_pgk)TzdSKaFx1`"]},"topLevel":true},"n":{"opcode":"data_setvariableto","next":"o","parent":"bm","inputs":{"VALUE":[3,"bn",[10,"85"]]},"fields":{"VARIABLE":["Body Contrast","]tJ;j{`j-u~U+HM|-OP*"]}},"o":{"opcode":"data_setvariableto","next":"p","parent":"n","inputs":{"VALUE":[3,"bo",[10,"0"]]},"fields":{"VARIABLE":["Body Color","%PW5e$t0ohXOqyC0E~$E"]}},"p":{"opcode":"data_setvariableto","next":"q","parent":"o","inputs":{"VALUE":[3,"bp",[10,"0"]]},"fields":{"VARIABLE":["Eyes Color","5xsG=$qKr=H?9%|qF!.#"]}},"q":{"opcode":"data_setvariableto","next":"r","parent":"p","inputs":{"VALUE":[3,"bq",[10,"100"]]},"fields":{"VARIABLE":["Eyes Contrast","8L,1TkQ}:c)~*EN{ab{V"]}},"r":{"opcode":"data_setvariableto","next":"s","parent":"q","inputs":{"VALUE":[3,"br",[10,"0"]]},"fields":{"VARIABLE":["Pupil Color","e~-{jKg0MfS`d%e1K{@z"]}},"s":{"opcode":"data_setvariableto","next":"t","parent":"r","inputs":{"VALUE":[3,"bs",[10,"100"]]},"fields":{"VARIABLE":["Pupil Contrast","Wma,x#poLj.05w6_Foa="]}},"t":{"opcode":"data_setvariableto","next":"u","parent":"s","inputs":{"VALUE":[3,"bt",[10,"0"]]},"fields":{"VARIABLE":["Body Brightness","Gi!J}=Ef+H,u%{#xi^Wp"]}},"u":{"opcode":"data_setvariableto","next":"v","parent":"t","inputs":{"VALUE":[3,"bu",[10,"0"]]},"fields":{"VARIABLE":["Pupil Brightness","@p7@CtPn%UpPY-BD6-j!"]}},"v":{"opcode":"data_setvariableto","next":"~","parent":"u","inputs":{"VALUE":[3,"bv",[10,"0"]]},"fields":{"VARIABLE":["Eyes Brightness","C)E0V%|Q^1xT,DIzc%O:"]}},"~":{"opcode":"data_setvariableto","next":null,"parent":"v","inputs":{"VALUE":[3,"bw",[10,"0"]]},"fields":{"VARIABLE":["Background Color","|n7veW$La9hD@l|k,gQ^"]}},"bn":{"opcode":"operator_random","next":null,"parent":"n","inputs":{"FROM":[1,[4,"70"]],"TO":[1,[4,"100"]]},"fields":{}},"bo":{"opcode":"operator_random","next":null,"parent":"o","inputs":{"FROM":[1,[4,"0"]],"TO":[1,[4,"200"]]},"fields":{}},"bp":{"opcode":"operator_random","next":null,"parent":"p","inputs":{"FROM":[1,[4,"0"]],"TO":[1,[4,"200"]]},"fields":{}},"bq":{"opcode":"operator_random","next":null,"parent":"q","inputs":{"FROM":[1,[4,"70"]],"TO":[1,[4,"100"]]},"fields":{}},"br":{"opcode":"operator_random","next":null,"parent":"r","inputs":{"FROM":[1,[4,"0"]],"TO":[1,[4,"200"]]},"fields":{}},"bs":{"opcode":"operator_random","next":null,"parent":"s","inputs":{"FROM":[1,[4,"70"]],"TO":[1,[4,"100"]]},"fields":{}},"bt":{"opcode":"operator_random","next":null,"parent":"t","inputs":{"FROM":[1,[4,"-65"]],"TO":[1,[4,"0"]]},"fields":{}},"bu":{"opcode":"operator_random","next":null,"parent":"u","inputs":{"FROM":[1,[4,"-65"]],"TO":[1,[4,"0"]]},"fields":{}},"bv":{"opcode":"operator_random","next":null,"parent":"v","inputs":{"FROM":[1,[4,"-65"]],"TO":[1,[4,"0"]]},"fields":{}},"bw":{"opcode":"operator_random","next":null,"parent":"~","inputs":{"FROM":[1,[4,"0"]],"TO":[1,[4,"200"]]},"fields":{}},"bx":{"opcode":"event_whenbroadcastreceived","next":"w","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["LightShow","GBB9B^vsI`0RYu{,dnz?"]},"topLevel":true},"w":{"opcode":"control_repeat_until","next":null,"parent":"bx","inputs":{"CONDITION":[2,"by"],"SUBSTACK":[2,"aa"]},"fields":{}},"by":{"opcode":"operator_equals","next":null,"parent":"w","inputs":{"OPERAND1":[3,[12,"LightShow","HCc`51#mPpGzbD8Mn,T9"],[10,""]],"OPERAND2":[1,[10,"0"]]},"fields":{}},"x":{"opcode":"data_setvariableto","next":"y","parent":"aa","inputs":{"VALUE":[3,"bz",[10,"85"]]},"fields":{"VARIABLE":["Body Contrast","]tJ;j{`j-u~U+HM|-OP*"]}},"bz":{"opcode":"operator_random","next":null,"parent":"x","inputs":{"FROM":[1,[4,"70"]],"TO":[1,[4,"100"]]},"fields":{}},"y":{"opcode":"data_setvariableto","next":"z","parent":"x","inputs":{"VALUE":[3,"bA",[10,"0"]]},"fields":{"VARIABLE":["Body Color","%PW5e$t0ohXOqyC0E~$E"]}},"bA":{"opcode":"operator_random","next":null,"parent":"y","inputs":{"FROM":[1,[4,"0"]],"TO":[1,[4,"200"]]},"fields":{}},"z":{"opcode":"data_setvariableto","next":"A","parent":"y","inputs":{"VALUE":[3,"bB",[10,"0"]]},"fields":{"VARIABLE":["Eyes Color","5xsG=$qKr=H?9%|qF!.#"]}},"bB":{"opcode":"operator_random","next":null,"parent":"z","inputs":{"FROM":[1,[4,"0"]],"TO":[1,[4,"200"]]},"fields":{}},"A":{"opcode":"data_setvariableto","next":"B","parent":"z","inputs":{"VALUE":[3,"bC",[10,"100"]]},"fields":{"VARIABLE":["Eyes Contrast","8L,1TkQ}:c)~*EN{ab{V"]}},"bC":{"opcode":"operator_random","next":null,"parent":"A","inputs":{"FROM":[1,[4,"70"]],"TO":[1,[4,"100"]]},"fields":{}},"B":{"opcode":"data_setvariableto","next":"C","parent":"A","inputs":{"VALUE":[3,"bD",[10,"0"]]},"fields":{"VARIABLE":["Pupil Color","e~-{jKg0MfS`d%e1K{@z"]}},"bD":{"opcode":"operator_random","next":null,"parent":"B","inputs":{"FROM":[1,[4,"0"]],"TO":[1,[4,"200"]]},"fields":{}},"C":{"opcode":"data_setvariableto","next":"D","parent":"B","inputs":{"VALUE":[3,"bE",[10,"100"]]},"fields":{"VARIABLE":["Pupil Contrast","Wma,x#poLj.05w6_Foa="]}},"bE":{"opcode":"operator_random","next":null,"parent":"C","inputs":{"FROM":[1,[4,"70"]],"TO":[1,[4,"100"]]},"fields":{}},"D":{"opcode":"data_setvariableto","next":"E","parent":"C","inputs":{"VALUE":[3,"bF",[10,"0"]]},"fields":{"VARIABLE":["Body Brightness","Gi!J}=Ef+H,u%{#xi^Wp"]}},"bF":{"opcode":"operator_random","next":null,"parent":"D","inputs":{"FROM":[1,[4,"-65"]],"TO":[1,[4,"0"]]},"fields":{}},"E":{"opcode":"data_setvariableto","next":"F","parent":"D","inputs":{"VALUE":[3,"bG",[10,"0"]]},"fields":{"VARIABLE":["Pupil Brightness","@p7@CtPn%UpPY-BD6-j!"]}},"bG":{"opcode":"operator_random","next":null,"parent":"E","inputs":{"FROM":[1,[4,"-65"]],"TO":[1,[4,"0"]]},"fields":{}},"F":{"opcode":"data_setvariableto","next":"ab","parent":"E","inputs":{"VALUE":[3,"bH",[10,"0"]]},"fields":{"VARIABLE":["Eyes Brightness","C)E0V%|Q^1xT,DIzc%O:"]}},"bH":{"opcode":"operator_random","next":null,"parent":"F","inputs":{"FROM":[1,[4,"-65"]],"TO":[1,[4,"0"]]},"fields":{}},"ab":{"opcode":"data_setvariableto","next":null,"parent":"F","inputs":{"VALUE":[3,"bI",[10,"0"]]},"fields":{"VARIABLE":["Background Color","|n7veW$La9hD@l|k,gQ^"]}},"bI":{"opcode":"operator_random","next":null,"parent":"ab","inputs":{"FROM":[1,[4,"0"]],"TO":[1,[4,"200"]]},"fields":{}},"aa":{"opcode":"control_wait","next":"x","parent":"w","inputs":{"DURATION":[1,[5,"0.238"]]},"fields":{}},"ac":{"opcode":"sound_playuntildone","next":null,"parent":"ad","inputs":{"SOUND_MENU":[1,"bJ"]},"fields":{}},"bJ":{"opcode":"sound_sounds_menu","next":null,"parent":"ac","inputs":{},"fields":{"SOUND_MENU":["ChuzzleDanceNoIntro",null]},"shadow":true},"bK":{"opcode":"event_whenbroadcastreceived","next":"c","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["LightShow","GBB9B^vsI`0RYu{,dnz?"]},"topLevel":true},"c":{"opcode":"control_repeat_until","next":"bL","parent":"bK","inputs":{"CONDITION":[2,"bM"],"SUBSTACK":[2,"ad"]},"fields":{}},"bM":{"opcode":"operator_equals","next":null,"parent":"c","inputs":{"OPERAND1":[3,[12,"LightShow","HCc`51#mPpGzbD8Mn,T9"],[10,""]],"OPERAND2":[1,[10,"0"]]},"fields":{}},"ad":{"opcode":"sound_stopallsounds","next":"ac","parent":"c","inputs":{},"fields":{}},"l":{"opcode":"control_if","next":null,"parent":"|","inputs":{"SUBSTACK":[2,"m"],"CONDITION":[2,"bN"]},"fields":{}},"bN":{"opcode":"operator_equals","next":null,"parent":"l","inputs":{"OPERAND1":[3,[12,"LightShow","HCc`51#mPpGzbD8Mn,T9"],[10,""]],"OPERAND2":[1,[10,"0"]]},"fields":{}},"bb":{"opcode":"data_setvariableto","next":null,"parent":"`","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["LightShow","HCc`51#mPpGzbD8Mn,T9"]}},"bL":{"opcode":"sound_stopallsounds","next":null,"parent":"c","inputs":{},"fields":{}}},"comments":{"c=":{"blockId":null,"x":50,"y":50,"width":350,"height":170,"minimized":false,"text":"Configuration for https://turbowarp.org/\nYou can move, resize, and minimize this comment, but don't edit it by hand. This comment can be deleted to remove the stored settings.\n{\"runtimeOptions\":{\"maxClones\":Infinity,\"fencing\":false},\"width\":1280,\"height\":720} // _twconfig_"}},"currentCostume":0,"costumes":[{"name":"bkg","bitmapResolution":1,"dataFormat":"svg","assetId":"061ada43337bfd4570a8312e8306d9ff","md5ext":"061ada43337bfd4570a8312e8306d9ff.svg","rotationCenterX":648.4084084084062,"rotationCenterY":364.7297297297301}],"sounds":[{"name":"SpeedChuzzle","assetId":"5978047b3271b7f00c05656d559a9e1e","dataFormat":"mp3","rate":48000,"sampleCount":7676926,"md5ext":"5978047b3271b7f00c05656d559a9e1e.mp3"},{"name":"Classic","assetId":"1f98d09ffd8e6a0eb3298359880f6e98","dataFormat":"mp3","rate":48000,"sampleCount":6912000,"md5ext":"1f98d09ffd8e6a0eb3298359880f6e98.mp3"},{"name":"ChuzzleDanceNoIntro","assetId":"edd7304e8e32c49f2f250b407e67b30a","dataFormat":"wav","format":"","rate":48000,"sampleCount":2193407,"md5ext":"edd7304e8e32c49f2f250b407e67b30a.wav"}],"volume":100,"layerOrder":0,"tempo":60,"videoTransparency":50,"videoState":"on","textToSpeechLanguage":null},{"isStage":false,"name":"ChuzzleBody","variables":{},"lists":{},"broadcasts":{},"blocks":{"bO":{"opcode":"event_whenflagclicked","next":"ae","parent":null,"inputs":{},"fields":{},"topLevel":true},"af":{"opcode":"control_forever","next":null,"parent":"ae","inputs":{"SUBSTACK":[2,"ag"]},"fields":{}},"ag":{"opcode":"looks_seteffectto","next":"d","parent":"af","inputs":{"VALUE":[3,[12,"Body Color","%PW5e$t0ohXOqyC0E~$E"],[4,"0"]]},"fields":{"EFFECT":["COLOR",null]}},"d":{"opcode":"SPlooksExpanded_setSpriteEffect","next":"bP","parent":"ag","inputs":{"EFFECT":[1,"bQ"],"TARGET":[1,"bR"],"VALUE":[3,[12,"Body Contrast","]tJ;j{`j-u~U+HM|-OP*"],[4,"0"]]},"fields":{}},"bQ":{"opcode":"SPlooksExpanded_menu_EFFECT_MENU","next":null,"parent":"d","inputs":{},"fields":{"EFFECT_MENU":["contrast",null]},"shadow":true},"bR":{"opcode":"SPlooksExpanded_menu_TARGETS","next":null,"parent":"d","inputs":{},"fields":{"TARGETS":["_myself_",null]},"shadow":true},"bS":{"opcode":"event_whenflagclicked","next":"ah","parent":null,"inputs":{},"fields":{},"topLevel":true},"ah":{"opcode":"control_forever","next":null,"parent":"bS","inputs":{"SUBSTACK":[2,"bT"]},"fields":{}},"bT":{"opcode":"looks_gotofrontback","next":null,"parent":"ah","inputs":{},"fields":{"FRONT_BACK":["back",null]}},"ae":{"opcode":"motion_gotoxy","next":"af","parent":"bO","inputs":{"X":[1,[4,"0"]],"Y":[1,[4,"0"]]},"fields":{}},"bP":{"opcode":"looks_seteffectto","next":null,"parent":"d","inputs":{"VALUE":[3,[12,"Body Brightness","Gi!J}=Ef+H,u%{#xi^Wp"],[4,"0"]]},"fields":{"EFFECT":["BRIGHTNESS",null]}}},"comments":{},"currentCostume":0,"costumes":[{"name":"ChuzzleBody","bitmapResolution":2,"dataFormat":"png","assetId":"3a76fa9560b491f44db5da6ee62f0337","md5ext":"3a76fa9560b491f44db5da6ee62f0337.png","rotationCenterX":713,"rotationCenterY":720}],"sounds":[],"volume":100,"layerOrder":1,"visible":true,"x":0,"y":0,"size":80,"direction":90,"draggable":false,"rotationStyle":"all around"},{"isStage":false,"name":"Eyes","variables":{},"lists":{},"broadcasts":{},"blocks":{"bU":{"opcode":"event_whenflagclicked","next":"G","parent":null,"inputs":{},"fields":{},"topLevel":true},"ai":{"opcode":"motion_gotoxy","next":"aj","parent":"G","inputs":{"X":[1,[4,"1"]],"Y":[1,[4,"-150"]]},"fields":{}},"aj":{"opcode":"control_forever","next":null,"parent":"ai","inputs":{"SUBSTACK":[2,"ak"]},"fields":{}},"ak":{"opcode":"looks_gotofrontback","next":"bV","parent":"aj","inputs":{},"fields":{"FRONT_BACK":["front",null]}},"bV":{"opcode":"looks_goforwardbackwardlayers","next":null,"parent":"ak","inputs":{"NUM":[1,[7,"2"]]},"fields":{"FORWARD_BACKWARD":["backward",null]}},"G":{"opcode":"looks_switchcostumeto","next":"ai","parent":"bU","inputs":{"COSTUME":[1,"bW"]},"fields":{}},"bW":{"opcode":"looks_costume","next":null,"parent":"G","inputs":{},"fields":{"COSTUME":["Eyes",null]},"shadow":true},"bX":{"opcode":"event_whenflagclicked","next":"al","parent":null,"inputs":{},"fields":{},"topLevel":true},"al":{"opcode":"control_forever","next":null,"parent":"bX","inputs":{"SUBSTACK":[2,"am"]},"fields":{}},"am":{"opcode":"looks_seteffectto","next":"e","parent":"al","inputs":{"VALUE":[3,[12,"Eyes Color","5xsG=$qKr=H?9%|qF!.#"],[4,"0"]]},"fields":{"EFFECT":["COLOR"]}},"e":{"opcode":"SPlooksExpanded_setSpriteEffect","next":"bY","parent":"am","inputs":{"EFFECT":[1,"bZ"],"TARGET":[1,"b!"],"VALUE":[3,[12,"Eyes Contrast","8L,1TkQ}:c)~*EN{ab{V"],[4,"0"]]},"fields":{}},"bZ":{"opcode":"SPlooksExpanded_menu_EFFECT_MENU","next":null,"parent":"e","inputs":{},"fields":{"EFFECT_MENU":["contrast"]},"shadow":true},"b!":{"opcode":"SPlooksExpanded_menu_TARGETS","next":null,"parent":"e","inputs":{},"fields":{"TARGETS":["_myself_"]},"shadow":true},"bY":{"opcode":"looks_seteffectto","next":null,"parent":"e","inputs":{"VALUE":[3,[12,"Eyes Brightness","C)E0V%|Q^1xT,DIzc%O:"],[4,"0"]]},"fields":{"EFFECT":["BRIGHTNESS",null]}},"b#":{"opcode":"event_whenbroadcastreceived","next":"b%","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["FlipEyes","Rf/QkD7[`*7*?(?z-=xt"]},"topLevel":true},"b%":{"opcode":"looks_nextcostume","next":null,"parent":"b#","inputs":{},"fields":{}},"b(":{"opcode":"event_whenbroadcastreceived","next":"f","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["Randomize",",yk.a_pgk)TzdSKaFx1`"]},"topLevel":true},"f":{"opcode":"motion_gotoxy","next":"an","parent":"b(","inputs":{"X":[3,"b)",[4,"1"]],"Y":[3,"b*",[4,"-150"]]},"fields":{}},"b)":{"opcode":"operator_random","next":null,"parent":"f","inputs":{"FROM":[1,[4,"-130"]],"TO":[1,[4,"181"]]},"fields":{}},"b*":{"opcode":"operator_random","next":null,"parent":"f","inputs":{"FROM":[1,[4,"-221"]],"TO":[1,[4,"170"]]},"fields":{}},"an":{"opcode":"event_broadcast","next":"ao","parent":"f","inputs":{"BROADCAST_INPUT":[1,[11,"RandomizePupils","5_i$-ayXxV$P1l4C*-A_"]]},"fields":{}},"ao":{"opcode":"looks_switchcostumeto","next":null,"parent":"an","inputs":{"COSTUME":[3,"b+","b,"]},"fields":{}},"b,":{"opcode":"looks_costume","next":null,"parent":null,"inputs":{},"fields":{"COSTUME":["Eyes2",null]},"shadow":true,"topLevel":true},"b+":{"opcode":"operator_random","next":null,"parent":"ao","inputs":{"FROM":[1,[4,"1"]],"TO":[1,[4,"2"]]},"fields":{}},"b-":{"opcode":"event_whenbroadcastreceived","next":"H","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["LightShow","GBB9B^vsI`0RYu{,dnz?"]},"topLevel":true},"g":{"opcode":"motion_gotoxy","next":"aq","parent":"ap","inputs":{"X":[3,"b.",[4,"1"]],"Y":[3,"b/",[4,"-150"]]},"fields":{}},"b.":{"opcode":"operator_random","next":null,"parent":"g","inputs":{"FROM":[1,[4,"-130"]],"TO":[1,[4,"181"]]},"fields":{}},"b/":{"opcode":"operator_random","next":null,"parent":"g","inputs":{"FROM":[1,[4,"-221"]],"TO":[1,[4,"170"]]},"fields":{}},"aq":{"opcode":"event_broadcast","next":"I","parent":"g","inputs":{"BROADCAST_INPUT":[1,[11,"RandomizePupils","5_i$-ayXxV$P1l4C*-A_"]]},"fields":{}},"I":{"opcode":"looks_switchcostumeto","next":null,"parent":"aq","inputs":{"COSTUME":[3,"b:","b;"]},"fields":{}},"b:":{"opcode":"operator_random","next":null,"parent":"I","inputs":{"FROM":[1,[4,"1"]],"TO":[1,[4,"2"]]},"fields":{}},"b;":{"opcode":"looks_costume","next":null,"parent":"I","inputs":{},"fields":{"COSTUME":["Eyes2",null]},"shadow":true},"H":{"opcode":"control_repeat_until","next":null,"parent":"b-","inputs":{"SUBSTACK":[2,"ap"],"CONDITION":[2,"b="]},"fields":{}},"b=":{"opcode":"operator_equals","next":null,"parent":"H","inputs":{"OPERAND1":[3,[12,"LightShow","HCc`51#mPpGzbD8Mn,T9"],[10,""]],"OPERAND2":[1,[10,"0"]]},"fields":{}},"ap":{"opcode":"control_wait","next":"g","parent":"H","inputs":{"DURATION":[1,[5,"0.238"]]},"fields":{}}},"comments":{},"currentCostume":0,"costumes":[{"name":"Eyes","bitmapResolution":2,"dataFormat":"png","assetId":"7d151da7215adce4eedee62f6b4183ac","md5ext":"7d151da7215adce4eedee62f6b4183ac.png","rotationCenterX":823,"rotationCenterY":512},{"name":"Eyes2","bitmapResolution":2,"dataFormat":"png","assetId":"d34633657abc681d83da393c675578f7","md5ext":"d34633657abc681d83da393c675578f7.png","rotationCenterX":823,"rotationCenterY":512}],"sounds":[],"volume":100,"layerOrder":8,"visible":true,"x":1,"y":-150,"size":30,"direction":90,"draggable":true,"rotationStyle":"all around"},{"isStage":false,"name":"Pupil 1","variables":{},"lists":{},"broadcasts":{},"blocks":{"b?":{"opcode":"event_whenflagclicked","next":"ar","parent":null,"inputs":{},"fields":{},"topLevel":true},"ar":{"opcode":"motion_gotoxy","next":"as","parent":"b?","inputs":{"X":[1,[4,"-58"]],"Y":[1,[4,"-143"]]},"fields":{}},"as":{"opcode":"control_forever","next":null,"parent":"ar","inputs":{"SUBSTACK":[2,"b@"]},"fields":{}},"b@":{"opcode":"looks_gotofrontback","next":null,"parent":"as","inputs":{},"fields":{"FRONT_BACK":["front",null]}},"b[":{"opcode":"event_whenflagclicked","next":"at","parent":null,"inputs":{},"fields":{},"topLevel":true},"at":{"opcode":"control_forever","next":null,"parent":"b[","inputs":{"SUBSTACK":[2,"au"]},"fields":{}},"au":{"opcode":"looks_seteffectto","next":"h","parent":"at","inputs":{"VALUE":[3,[12,"Pupil Color","e~-{jKg0MfS`d%e1K{@z"],[4,"0"]]},"fields":{"EFFECT":["COLOR",null]}},"h":{"opcode":"SPlooksExpanded_setSpriteEffect","next":"b]","parent":"au","inputs":{"EFFECT":[1,"b^"],"TARGET":[1,"b_"],"VALUE":[3,[12,"Pupil Contrast","Wma,x#poLj.05w6_Foa="],[4,"0"]]},"fields":{}},"b^":{"opcode":"SPlooksExpanded_menu_EFFECT_MENU","next":null,"parent":"h","inputs":{},"fields":{"EFFECT_MENU":["contrast",null]},"shadow":true},"b_":{"opcode":"SPlooksExpanded_menu_TARGETS","next":null,"parent":"h","inputs":{},"fields":{"TARGETS":["_myself_",null]},"shadow":true},"b]":{"opcode":"looks_seteffectto","next":null,"parent":"h","inputs":{"VALUE":[3,[12,"Pupil Brightness","@p7@CtPn%UpPY-BD6-j!"],[4,"0"]]},"fields":{"EFFECT":["BRIGHTNESS",null]}},"b`":{"opcode":"event_whenbroadcastreceived","next":"J","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["RandomizePupils","5_i$-ayXxV$P1l4C*-A_"]},"topLevel":true},"J":{"opcode":"motion_gotoxy","next":null,"parent":"b`","inputs":{"X":[3,"K",[4,"23"]],"Y":[3,"L",[4,"112"]]},"fields":{}},"K":{"opcode":"operator_add","next":null,"parent":"J","inputs":{"NUM1":[3,"av",[4,""]],"NUM2":[3,"b{",[4,""]]},"fields":{}},"av":{"opcode":"sensing_of","next":null,"parent":"K","inputs":{"OBJECT":[1,"b|"]},"fields":{"PROPERTY":["x position",null]}},"b|":{"opcode":"sensing_of_object_menu","next":null,"parent":"av","inputs":{},"fields":{"OBJECT":["Eyes",null]},"shadow":true},"b{":{"opcode":"operator_random","next":null,"parent":"K","inputs":{"FROM":[1,[4,"-84"]],"TO":[1,[4,"-36"]]},"fields":{}},"aw":{"opcode":"sensing_of","next":null,"parent":"L","inputs":{"OBJECT":[1,"b}"]},"fields":{"PROPERTY":["y position",null]}},"b}":{"opcode":"sensing_of_object_menu","next":null,"parent":"aw","inputs":{},"fields":{"OBJECT":["Eyes",null]},"shadow":true},"L":{"opcode":"operator_add","next":null,"parent":"J","inputs":{"NUM1":[3,"aw",[4,""]],"NUM2":[3,"b~",[4,""]]},"fields":{}},"b~":{"opcode":"operator_random","next":null,"parent":"L","inputs":{"FROM":[1,[4,"-11"]],"TO":[1,[4,"39"]]},"fields":{}}},"comments":{},"currentCostume":0,"costumes":[{"name":"Pupil","bitmapResolution":2,"dataFormat":"png","assetId":"e25941f583343f879acfa67334160610","md5ext":"e25941f583343f879acfa67334160610.png","rotationCenterX":211,"rotationCenterY":211}],"sounds":[],"volume":100,"layerOrder":9,"visible":true,"x":-58,"y":-143,"size":30,"direction":90,"draggable":true,"rotationStyle":"all around"},{"isStage":false,"name":"Pupil 2","variables":{},"lists":{},"broadcasts":{},"blocks":{"ca":{"opcode":"event_whenflagclicked","next":"ax","parent":null,"inputs":{},"fields":{},"topLevel":true},"ay":{"opcode":"control_forever","next":null,"parent":"ax","inputs":{"SUBSTACK":[2,"cb"]},"fields":{}},"cb":{"opcode":"looks_gotofrontback","next":null,"parent":"ay","inputs":{},"fields":{"FRONT_BACK":["front"]}},"ax":{"opcode":"motion_gotoxy","next":"ay","parent":"ca","inputs":{"X":[1,[4,"36"]],"Y":[1,[4,"-156"]]},"fields":{}},"cc":{"opcode":"event_whenflagclicked","next":"az","parent":null,"inputs":{},"fields":{},"topLevel":true},"az":{"opcode":"control_forever","next":null,"parent":"cc","inputs":{"SUBSTACK":[2,"aA"]},"fields":{}},"aA":{"opcode":"looks_seteffectto","next":"i","parent":"az","inputs":{"VALUE":[3,[12,"Pupil Color","e~-{jKg0MfS`d%e1K{@z"],[4,"0"]]},"fields":{"EFFECT":["COLOR"]}},"i":{"opcode":"SPlooksExpanded_setSpriteEffect","next":"cd","parent":"aA","inputs":{"EFFECT":[1,"ce"],"TARGET":[1,"cf"],"VALUE":[3,[12,"Pupil Contrast","Wma,x#poLj.05w6_Foa="],[4,"0"]]},"fields":{}},"ce":{"opcode":"SPlooksExpanded_menu_EFFECT_MENU","next":null,"parent":"i","inputs":{},"fields":{"EFFECT_MENU":["contrast"]},"shadow":true},"cf":{"opcode":"SPlooksExpanded_menu_TARGETS","next":null,"parent":"i","inputs":{},"fields":{"TARGETS":["_myself_"]},"shadow":true},"cd":{"opcode":"looks_seteffectto","next":null,"parent":"i","inputs":{"VALUE":[3,[12,"Pupil Brightness","@p7@CtPn%UpPY-BD6-j!"],[4,"0"]]},"fields":{"EFFECT":["BRIGHTNESS"]}},"cg":{"opcode":"event_whenbroadcastreceived","next":"M","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["RandomizePupils","5_i$-ayXxV$P1l4C*-A_"]},"topLevel":true},"M":{"opcode":"motion_gotoxy","next":null,"parent":"cg","inputs":{"X":[3,"N",[4,"23"]],"Y":[3,"O",[4,"112"]]},"fields":{}},"N":{"opcode":"operator_add","next":null,"parent":"M","inputs":{"NUM1":[3,"aB",[4,""]],"NUM2":[3,"ch",[4,""]]},"fields":{}},"aB":{"opcode":"sensing_of","next":null,"parent":"N","inputs":{"OBJECT":[1,"ci"]},"fields":{"PROPERTY":["x position"]}},"ci":{"opcode":"sensing_of_object_menu","next":null,"parent":"aB","inputs":{},"fields":{"OBJECT":["Eyes"]},"shadow":true},"ch":{"opcode":"operator_random","next":null,"parent":"N","inputs":{"FROM":[1,[4,"32"]],"TO":[1,[4,"85"]]},"fields":{}},"O":{"opcode":"operator_add","next":null,"parent":"M","inputs":{"NUM1":[3,"aC",[4,""]],"NUM2":[3,"cj",[4,""]]},"fields":{}},"aC":{"opcode":"sensing_of","next":null,"parent":"O","inputs":{"OBJECT":[1,"ck"]},"fields":{"PROPERTY":["y position"]}},"ck":{"opcode":"sensing_of_object_menu","next":null,"parent":"aC","inputs":{},"fields":{"OBJECT":["Eyes"]},"shadow":true},"cj":{"opcode":"operator_random","next":null,"parent":"O","inputs":{"FROM":[1,[4,"-11"]],"TO":[1,[4,"39"]]},"fields":{}}},"comments":{},"currentCostume":0,"costumes":[{"name":"Pupil","bitmapResolution":2,"dataFormat":"png","assetId":"e25941f583343f879acfa67334160610","md5ext":"e25941f583343f879acfa67334160610.png","rotationCenterX":211,"rotationCenterY":211}],"sounds":[],"volume":100,"layerOrder":10,"visible":true,"x":36,"y":-156,"size":30,"direction":90,"draggable":true,"rotationStyle":"all around"},{"isStage":false,"name":"Flip eyes","variables":{},"lists":{},"broadcasts":{},"blocks":{"cl":{"opcode":"event_whenflagclicked","next":"aD","parent":null,"inputs":{},"fields":{},"topLevel":true},"aD":{"opcode":"motion_gotoxy","next":"aE","parent":"cl","inputs":{"X":[1,[4,"508"]],"Y":[1,[4,"-302"]]},"fields":{}},"aE":{"opcode":"looks_switchcostumeto","next":null,"parent":"aD","inputs":{"COSTUME":[1,"cm"]},"fields":{}},"cm":{"opcode":"looks_costume","next":null,"parent":"aE","inputs":{},"fields":{"COSTUME":["button2-a",null]},"shadow":true},"cn":{"opcode":"event_whenthisspriteclicked","next":"P","parent":null,"inputs":{},"fields":{},"topLevel":true},"P":{"opcode":"looks_switchcostumeto","next":"Q","parent":"cn","inputs":{"COSTUME":[1,"co"]},"fields":{}},"co":{"opcode":"looks_costume","next":null,"parent":"P","inputs":{},"fields":{"COSTUME":["button2-b",null]},"shadow":true},"aF":{"opcode":"event_broadcast","next":"R","parent":"Q","inputs":{"BROADCAST_INPUT":[1,[11,"FlipEyes","Rf/QkD7[`*7*?(?z-=xt"]]},"fields":{}},"R":{"opcode":"control_wait_until","next":"aG","parent":"aF","inputs":{"CONDITION":[2,"S"]},"fields":{}},"S":{"opcode":"operator_or","next":null,"parent":"R","inputs":{"OPERAND1":[2,"aH"],"OPERAND2":[2,"aI"]},"fields":{}},"aH":{"opcode":"operator_not","next":null,"parent":"S","inputs":{"OPERAND":[2,"aJ"]},"fields":{}},"aJ":{"opcode":"sensing_touchingobject","next":null,"parent":"aH","inputs":{"TOUCHINGOBJECTMENU":[1,"cp"]},"fields":{}},"cp":{"opcode":"sensing_touchingobjectmenu","next":null,"parent":"aJ","inputs":{},"fields":{"TOUCHINGOBJECTMENU":["_mouse_",null]},"shadow":true},"aI":{"opcode":"operator_not","next":null,"parent":"S","inputs":{"OPERAND":[2,"cq"]},"fields":{}},"cq":{"opcode":"sensing_mousedown","next":null,"parent":"aI","inputs":{},"fields":{}},"aG":{"opcode":"looks_switchcostumeto","next":null,"parent":"R","inputs":{"COSTUME":[1,"cr"]},"fields":{}},"cr":{"opcode":"looks_costume","next":null,"parent":"aG","inputs":{},"fields":{"COSTUME":["button2-a",null]},"shadow":true},"Q":{"opcode":"sound_play","next":"aF","parent":"P","inputs":{"SOUND_MENU":[1,"cs"]},"fields":{}},"cs":{"opcode":"sound_sounds_menu","next":null,"parent":"Q","inputs":{},"fields":{"SOUND_MENU":["GameSelect",null]},"shadow":true}},"comments":{},"currentCostume":0,"costumes":[{"name":"button2-a","bitmapResolution":1,"dataFormat":"svg","assetId":"57f382df0814e49e07f56da0c294211e","md5ext":"57f382df0814e49e07f56da0c294211e.svg","rotationCenterX":60,"rotationCenterY":26.143500000000017},{"name":"button2-b","bitmapResolution":1,"dataFormat":"svg","assetId":"a87a7063ee9068e147a050a3281ebe5e","md5ext":"a87a7063ee9068e147a050a3281ebe5e.svg","rotationCenterX":60,"rotationCenterY":26.14349999999996}],"sounds":[{"name":"GameSelect","assetId":"c056c7deb601c08bf79e12343cecf6f9","dataFormat":"wav","rate":48000,"sampleCount":10797,"md5ext":"c056c7deb601c08bf79e12343cecf6f9.wav"}],"volume":100,"layerOrder":6,"visible":true,"x":508,"y":-302,"size":200,"direction":90,"draggable":false,"rotationStyle":"all around"},{"isStage":false,"name":"Finished button","variables":{},"lists":{},"broadcasts":{},"blocks":{"ct":{"opcode":"event_whenflagclicked","next":"aK","parent":null,"inputs":{},"fields":{},"topLevel":true},"aK":{"opcode":"motion_gotoxy","next":"aL","parent":"ct","inputs":{"X":[1,[4,"-508"]],"Y":[1,[4,"-302"]]},"fields":{}},"aL":{"opcode":"looks_switchcostumeto","next":null,"parent":"aK","inputs":{"COSTUME":[1,"cu"]},"fields":{}},"cu":{"opcode":"looks_costume","next":null,"parent":"aL","inputs":{},"fields":{"COSTUME":["button2-a",null]},"shadow":true},"cv":{"opcode":"event_whenthisspriteclicked","next":"T","parent":null,"inputs":{},"fields":{},"topLevel":true},"T":{"opcode":"looks_switchcostumeto","next":"U","parent":"cv","inputs":{"COSTUME":[1,"cw"]},"fields":{}},"cw":{"opcode":"looks_costume","next":null,"parent":"T","inputs":{},"fields":{"COSTUME":["button2-b",null]},"shadow":true},"U":{"opcode":"sound_play","next":"aM","parent":"T","inputs":{"SOUND_MENU":[1,"cx"]},"fields":{}},"cx":{"opcode":"sound_sounds_menu","next":null,"parent":"U","inputs":{},"fields":{"SOUND_MENU":["GameSelect",null]},"shadow":true},"aM":{"opcode":"runtimeoptions_setDimensions","next":"V","parent":"U","inputs":{"width":[1,[4,"720"]],"height":[1,[4,"720"]]},"fields":{}},"V":{"opcode":"files_downloadURL","next":"aN","parent":"aM","inputs":{"url":[3,"cy",[10,"data:text/plain;base64,SGVsbG8sIHdvcmxkIQ=="]],"file":[1,[10,"CustomChuzzle.png"]]},"fields":{}},"cy":{"opcode":"lmsLooksPlus_snapshotStage","next":null,"parent":"V","inputs":{},"fields":{}},"aN":{"opcode":"control_wait","next":"aO","parent":"V","inputs":{"DURATION":[1,[5,"0.5"]]},"fields":{}},"aO":{"opcode":"runtimeoptions_setDimensions","next":"W","parent":"aN","inputs":{"width":[1,[4,"1280"]],"height":[1,[4,"720"]]},"fields":{}},"W":{"opcode":"control_wait_until","next":"aP","parent":"aO","inputs":{"CONDITION":[2,"X"]},"fields":{}},"X":{"opcode":"operator_or","next":null,"parent":"W","inputs":{"OPERAND1":[2,"aQ"],"OPERAND2":[2,"aR"]},"fields":{}},"aQ":{"opcode":"operator_not","next":null,"parent":"X","inputs":{"OPERAND":[2,"aS"]},"fields":{}},"aS":{"opcode":"sensing_touchingobject","next":null,"parent":"aQ","inputs":{"TOUCHINGOBJECTMENU":[1,"cz"]},"fields":{}},"cz":{"opcode":"sensing_touchingobjectmenu","next":null,"parent":"aS","inputs":{},"fields":{"TOUCHINGOBJECTMENU":["_mouse_",null]},"shadow":true},"aR":{"opcode":"operator_not","next":null,"parent":"X","inputs":{"OPERAND":[2,"cA"]},"fields":{}},"cA":{"opcode":"sensing_mousedown","next":null,"parent":"aR","inputs":{},"fields":{}},"aP":{"opcode":"looks_switchcostumeto","next":null,"parent":"W","inputs":{"COSTUME":[1,"cB"]},"fields":{}},"cB":{"opcode":"looks_costume","next":null,"parent":"aP","inputs":{},"fields":{"COSTUME":["button2-a",null]},"shadow":true}},"comments":{},"currentCostume":0,"costumes":[{"name":"button2-a","bitmapResolution":1,"dataFormat":"svg","assetId":"22cb12c6e73d5c3e96933b6f00a5f3ee","md5ext":"22cb12c6e73d5c3e96933b6f00a5f3ee.svg","rotationCenterX":60,"rotationCenterY":26.143500000000017},{"name":"button2-b","bitmapResolution":1,"dataFormat":"svg","assetId":"ea0b0d49a9257e7ec408b6624da35fed","md5ext":"ea0b0d49a9257e7ec408b6624da35fed.svg","rotationCenterX":60,"rotationCenterY":26.14349999999996}],"sounds":[{"name":"GameSelect","assetId":"c056c7deb601c08bf79e12343cecf6f9","dataFormat":"wav","rate":48000,"sampleCount":10797,"md5ext":"c056c7deb601c08bf79e12343cecf6f9.wav"}],"volume":100,"layerOrder":2,"visible":true,"x":-508,"y":-302,"size":200,"direction":90,"draggable":false,"rotationStyle":"all around"},{"isStage":false,"name":"Reset Button","variables":{},"lists":{},"broadcasts":{},"blocks":{"cC":{"opcode":"event_whenflagclicked","next":"aT","parent":null,"inputs":{},"fields":{},"topLevel":true},"aT":{"opcode":"motion_gotoxy","next":"aU","parent":"cC","inputs":{"X":[1,[4,"-508"]],"Y":[1,[4,"-160"]]},"fields":{}},"aU":{"opcode":"looks_switchcostumeto","next":null,"parent":"aT","inputs":{"COSTUME":[1,"cD"]},"fields":{}},"cD":{"opcode":"looks_costume","next":null,"parent":"aU","inputs":{},"fields":{"COSTUME":["button2-a",null]},"shadow":true},"cE":{"opcode":"event_whenthisspriteclicked","next":"j","parent":null,"inputs":{},"fields":{},"topLevel":true},"Y":{"opcode":"looks_switchcostumeto","next":"Z","parent":"j","inputs":{"COSTUME":[1,"cF"]},"fields":{}},"cF":{"opcode":"looks_costume","next":null,"parent":"Y","inputs":{},"fields":{"COSTUME":["button2-b",null]},"shadow":true},"Z":{"opcode":"sound_play","next":"aV","parent":"Y","inputs":{"SOUND_MENU":[1,"cG"]},"fields":{}},"cG":{"opcode":"sound_sounds_menu","next":null,"parent":"Z","inputs":{},"fields":{"SOUND_MENU":["GameSelect",null]},"shadow":true},"aV":{"opcode":"event_broadcast","next":"aW","parent":"Z","inputs":{"BROADCAST_INPUT":[1,[11,"Reset","vP7~JUc;bMPval3NJGSR"]]},"fields":{}},"!":{"opcode":"control_wait_until","next":"aX","parent":"aW","inputs":{"CONDITION":[2,"#"]},"fields":{}},"#":{"opcode":"operator_or","next":null,"parent":"!","inputs":{"OPERAND1":[2,"aY"],"OPERAND2":[2,"aZ"]},"fields":{}},"aY":{"opcode":"operator_not","next":null,"parent":"#","inputs":{"OPERAND":[2,"a!"]},"fields":{}},"a!":{"opcode":"sensing_touchingobject","next":null,"parent":"aY","inputs":{"TOUCHINGOBJECTMENU":[1,"cH"]},"fields":{}},"cH":{"opcode":"sensing_touchingobjectmenu","next":null,"parent":"a!","inputs":{},"fields":{"TOUCHINGOBJECTMENU":["_mouse_",null]},"shadow":true},"aZ":{"opcode":"operator_not","next":null,"parent":"#","inputs":{"OPERAND":[2,"cI"]},"fields":{}},"cI":{"opcode":"sensing_mousedown","next":null,"parent":"aZ","inputs":{},"fields":{}},"aX":{"opcode":"looks_switchcostumeto","next":null,"parent":"!","inputs":{"COSTUME":[1,"cJ"]},"fields":{}},"cJ":{"opcode":"looks_costume","next":null,"parent":"aX","inputs":{},"fields":{"COSTUME":["button2-a",null]},"shadow":true},"j":{"opcode":"control_if_else","next":null,"parent":"cE","inputs":{"SUBSTACK2":[2,"Y"],"CONDITION":[2,"cK"],"SUBSTACK":[2,"cL"]},"fields":{}},"cK":{"opcode":"operator_equals","next":null,"parent":"j","inputs":{"OPERAND1":[3,[12,"ResetConfirm?","L=zp+?]p`L|-6%%I5}Vq"],[10,""]],"OPERAND2":[1,[10,"1"]]},"fields":{}},"cL":{"opcode":"runtimeoptions_greenFlag","next":null,"parent":"j","inputs":{},"fields":{}},"aW":{"opcode":"data_setvariableto","next":"!","parent":"aV","inputs":{"VALUE":[1,[10,"1"]]},"fields":{"VARIABLE":["ResetConfirm?","L=zp+?]p`L|-6%%I5}Vq"]}},"cM":{"opcode":"event_whenbroadcastreceived","next":"a#","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["Reset","vP7~JUc;bMPval3NJGSR"]},"topLevel":true},"%":{"opcode":"operator_and","next":null,"parent":"(","inputs":{"OPERAND1":[2,"cN"],"OPERAND2":[2,"a%"]},"fields":{}},"cN":{"opcode":"sensing_mousedown","next":null,"parent":"%","inputs":{},"fields":{}},"a%":{"opcode":"operator_not","next":null,"parent":"%","inputs":{"OPERAND":[2,"a("]},"fields":{}},"a(":{"opcode":"sensing_touchingobject","next":null,"parent":"a%","inputs":{"TOUCHINGOBJECTMENU":[1,"cO"]},"fields":{}},"cO":{"opcode":"sensing_touchingobjectmenu","next":null,"parent":"a(","inputs":{},"fields":{"TOUCHINGOBJECTMENU":["_mouse_",null]},"shadow":true},"(":{"opcode":"control_if","next":null,"parent":"a#","inputs":{"CONDITION":[2,"%"],"SUBSTACK":[2,"a)"]},"fields":{}},"a*":{"opcode":"event_broadcast","next":"cP","parent":"a)","inputs":{"BROADCAST_INPUT":[1,[11,"ResetCancel","Vy~T-^:%qk]4|13E$%Rl"]]},"fields":{}},"a)":{"opcode":"data_setvariableto","next":"a*","parent":"(","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["ResetConfirm?","L=zp+?]p`L|-6%%I5}Vq"]}},"a#":{"opcode":"control_forever","next":null,"parent":"cM","inputs":{"SUBSTACK":[2,"("]},"fields":{}},"cP":{"opcode":"control_stop","next":null,"parent":"a*","inputs":{},"fields":{"STOP_OPTION":["this script",null]},"mutation":{"tagName":"mutation","children":[],"hasnext":"false"}}},"comments":{},"currentCostume":0,"costumes":[{"name":"button2-a","bitmapResolution":1,"dataFormat":"svg","assetId":"49efe9ef2103916e38f5e2db8d880397","md5ext":"49efe9ef2103916e38f5e2db8d880397.svg","rotationCenterX":60,"rotationCenterY":26.143500000000017},{"name":"button2-b","bitmapResolution":1,"dataFormat":"svg","assetId":"b2ac94910bb2c1f28e0aa095cc029c71","md5ext":"b2ac94910bb2c1f28e0aa095cc029c71.svg","rotationCenterX":60,"rotationCenterY":26.14349999999996}],"sounds":[{"name":"GameSelect","assetId":"c056c7deb601c08bf79e12343cecf6f9","dataFormat":"wav","rate":48000,"sampleCount":10797,"md5ext":"c056c7deb601c08bf79e12343cecf6f9.wav"}],"volume":100,"layerOrder":3,"visible":true,"x":-508,"y":-160,"size":200,"direction":90,"draggable":false,"rotationStyle":"all around"},{"isStage":false,"name":"Reset Text","variables":{},"lists":{},"broadcasts":{},"blocks":{"cQ":{"opcode":"event_whenflagclicked","next":"a+","parent":null,"inputs":{},"fields":{},"topLevel":true},"a+":{"opcode":"looks_hide","next":"cR","parent":"cQ","inputs":{},"fields":{}},"cR":{"opcode":"motion_gotoxy","next":null,"parent":"a+","inputs":{"X":[1,[4,"-499"]],"Y":[1,[4,"-66"]]},"fields":{}},"cS":{"opcode":"event_whenbroadcastreceived","next":"cT","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["Reset","vP7~JUc;bMPval3NJGSR"]},"topLevel":true},"cT":{"opcode":"looks_show","next":null,"parent":"cS","inputs":{},"fields":{}},"cU":{"opcode":"event_whenbroadcastreceived","next":"cV","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["ResetCancel","Vy~T-^:%qk]4|13E$%Rl"]},"topLevel":true},"cV":{"opcode":"looks_hide","next":null,"parent":"cU","inputs":{},"fields":{}}},"comments":{},"currentCostume":0,"costumes":[{"name":"costume1","bitmapResolution":1,"dataFormat":"svg","assetId":"64f7aa8b8ca9169d6ec9500fbaabcaa6","md5ext":"64f7aa8b8ca9169d6ec9500fbaabcaa6.svg","rotationCenterX":142.45170076094837,"rotationCenterY":32.74694199096825}],"sounds":[],"volume":100,"layerOrder":7,"visible":false,"x":-499,"y":-66,"size":100,"direction":90,"draggable":false,"rotationStyle":"all around"},{"isStage":false,"name":"Randomize","variables":{},"lists":{},"broadcasts":{},"blocks":{"cW":{"opcode":"event_whenflagclicked","next":"a,","parent":null,"inputs":{},"fields":{},"topLevel":true},"a,":{"opcode":"motion_gotoxy","next":"a-","parent":"cW","inputs":{"X":[1,[4,"508"]],"Y":[1,[4,"-160"]]},"fields":{}},"a-":{"opcode":"looks_switchcostumeto","next":null,"parent":"a,","inputs":{"COSTUME":[1,"cX"]},"fields":{}},"cX":{"opcode":"looks_costume","next":null,"parent":"a-","inputs":{},"fields":{"COSTUME":["button2-a",null]},"shadow":true},"cY":{"opcode":"event_whenthisspriteclicked","next":")","parent":null,"inputs":{},"fields":{},"topLevel":true},")":{"opcode":"looks_switchcostumeto","next":"a.","parent":"cY","inputs":{"COSTUME":[1,"cZ"]},"fields":{}},"cZ":{"opcode":"looks_costume","next":null,"parent":")","inputs":{},"fields":{"COSTUME":["button2-b",null]},"shadow":true},"a.":{"opcode":"event_broadcast","next":"*","parent":")","inputs":{"BROADCAST_INPUT":[1,[11,"Randomize",",yk.a_pgk)TzdSKaFx1`"]]},"fields":{}},"*":{"opcode":"sound_play","next":"+","parent":"a.","inputs":{"SOUND_MENU":[1,"c!"]},"fields":{}},"c!":{"opcode":"sound_sounds_menu","next":null,"parent":"*","inputs":{},"fields":{"SOUND_MENU":["Click",null]},"shadow":true},"+":{"opcode":"control_wait_until","next":"a/","parent":"*","inputs":{"CONDITION":[2,","]},"fields":{}},",":{"opcode":"operator_or","next":null,"parent":"+","inputs":{"OPERAND1":[2,"a:"],"OPERAND2":[2,"a;"]},"fields":{}},"a:":{"opcode":"operator_not","next":null,"parent":",","inputs":{"OPERAND":[2,"a="]},"fields":{}},"a=":{"opcode":"sensing_touchingobject","next":null,"parent":"a:","inputs":{"TOUCHINGOBJECTMENU":[1,"c#"]},"fields":{}},"c#":{"opcode":"sensing_touchingobjectmenu","next":null,"parent":"a=","inputs":{},"fields":{"TOUCHINGOBJECTMENU":["_mouse_",null]},"shadow":true},"a;":{"opcode":"operator_not","next":null,"parent":",","inputs":{"OPERAND":[2,"c%"]},"fields":{}},"c%":{"opcode":"sensing_mousedown","next":null,"parent":"a;","inputs":{},"fields":{}},"a/":{"opcode":"looks_switchcostumeto","next":null,"parent":"+","inputs":{"COSTUME":[1,"c("]},"fields":{}},"c(":{"opcode":"looks_costume","next":null,"parent":"a/","inputs":{},"fields":{"COSTUME":["button2-a",null]},"shadow":true}},"comments":{},"currentCostume":0,"costumes":[{"name":"button2-a","bitmapResolution":1,"dataFormat":"svg","assetId":"cefa536395ef91061c40cf38f6950033","md5ext":"cefa536395ef91061c40cf38f6950033.svg","rotationCenterX":60,"rotationCenterY":26.143500000000017},{"name":"button2-b","bitmapResolution":1,"dataFormat":"svg","assetId":"1bc0178df1a9df795c9cbd51614a2bfb","md5ext":"1bc0178df1a9df795c9cbd51614a2bfb.svg","rotationCenterX":60,"rotationCenterY":26.14349999999996}],"sounds":[{"name":"Click","assetId":"8162db603a8b0b2cbe623093892d1f97","dataFormat":"wav","rate":48000,"sampleCount":6060,"md5ext":"8162db603a8b0b2cbe623093892d1f97.wav"}],"volume":100,"layerOrder":5,"visible":true,"x":508,"y":-160,"size":200,"direction":90,"draggable":false,"rotationStyle":"all around"},{"isStage":false,"name":"Light Show","variables":{},"lists":{},"broadcasts":{},"blocks":{"c)":{"opcode":"event_whenflagclicked","next":"a?","parent":null,"inputs":{},"fields":{},"topLevel":true},"a?":{"opcode":"motion_gotoxy","next":"a@","parent":"c)","inputs":{"X":[1,[4,"508"]],"Y":[1,[4,"-30"]]},"fields":{}},"a@":{"opcode":"looks_switchcostumeto","next":null,"parent":"a?","inputs":{"COSTUME":[1,"c*"]},"fields":{}},"c*":{"opcode":"looks_costume","next":null,"parent":"a@","inputs":{},"fields":{"COSTUME":["button2-a",null]},"shadow":true},"c+":{"opcode":"event_whenthisspriteclicked","next":"a","parent":null,"inputs":{},"fields":{},"topLevel":true},"a[":{"opcode":"looks_switchcostumeto","next":null,"parent":"a]","inputs":{"COSTUME":[1,"c,"]},"fields":{}},"c,":{"opcode":"looks_costume","next":null,"parent":"a[","inputs":{},"fields":{"COSTUME":["button2-b",null]},"shadow":true},"a":{"opcode":"control_if_else","next":"a^","parent":"c+","inputs":{"CONDITION":[2,"c-"],"SUBSTACK":[2,"a]"],"SUBSTACK2":[2,"a_"]},"fields":{}},"c-":{"opcode":"operator_equals","next":null,"parent":"a","inputs":{"OPERAND1":[3,[12,"LightShow","HCc`51#mPpGzbD8Mn,T9"],[10,""]],"OPERAND2":[1,[10,"0"]]},"fields":{}},"a]":{"opcode":"data_setvariableto","next":"a[","parent":"a","inputs":{"VALUE":[1,[10,"1"]]},"fields":{"VARIABLE":["LightShow","HCc`51#mPpGzbD8Mn,T9"]}},"a_":{"opcode":"data_setvariableto","next":"a`","parent":"a","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["LightShow","HCc`51#mPpGzbD8Mn,T9"]}},"a^":{"opcode":"event_broadcast","next":"-","parent":"a","inputs":{"BROADCAST_INPUT":[1,[11,"LightShow","GBB9B^vsI`0RYu{,dnz?"]]},"fields":{}},"-":{"opcode":"sound_play","next":"a{","parent":"a^","inputs":{"SOUND_MENU":[1,"c."]},"fields":{}},"c.":{"opcode":"sound_sounds_menu","next":null,"parent":"-","inputs":{},"fields":{"SOUND_MENU":["Click",null]},"shadow":true},"a{":{"opcode":"control_wait_until","next":null,"parent":"-","inputs":{"CONDITION":[2,"."]},"fields":{}},".":{"opcode":"operator_or","next":null,"parent":"a{","inputs":{"OPERAND1":[2,"a|"],"OPERAND2":[2,"a}"]},"fields":{}},"a|":{"opcode":"operator_not","next":null,"parent":".","inputs":{"OPERAND":[2,"a~"]},"fields":{}},"a~":{"opcode":"sensing_touchingobject","next":null,"parent":"a|","inputs":{"TOUCHINGOBJECTMENU":[1,"c/"]},"fields":{}},"c/":{"opcode":"sensing_touchingobjectmenu","next":null,"parent":"a~","inputs":{},"fields":{"TOUCHINGOBJECTMENU":["_mouse_",null]},"shadow":true},"a}":{"opcode":"operator_not","next":null,"parent":".","inputs":{"OPERAND":[2,"c:"]},"fields":{}},"c:":{"opcode":"sensing_mousedown","next":null,"parent":"a}","inputs":{},"fields":{}},"a`":{"opcode":"looks_switchcostumeto","next":null,"parent":"a_","inputs":{"COSTUME":[1,"c;"]},"fields":{}},"c;":{"opcode":"looks_costume","next":null,"parent":"a`","inputs":{},"fields":{"COSTUME":["button2-a",null]},"shadow":true},"c=":{"opcode":"event_broadcast","next":null,"parent":null,"inputs":{"BROADCAST_INPUT":[1,[11,"Randomize",",yk.a_pgk)TzdSKaFx1`"]]},"fields":{},"topLevel":true}},"comments":{},"currentCostume":0,"costumes":[{"name":"button2-a","bitmapResolution":1,"dataFormat":"svg","assetId":"e97a62a39fb0901b386cb8a88b56b5ae","md5ext":"e97a62a39fb0901b386cb8a88b56b5ae.svg","rotationCenterX":60,"rotationCenterY":26.143500000000017},{"name":"button2-b","bitmapResolution":1,"dataFormat":"svg","assetId":"77401d2c88e994a1fe2249b776c3c87b","md5ext":"77401d2c88e994a1fe2249b776c3c87b.svg","rotationCenterX":60,"rotationCenterY":26.14349999999996}],"sounds":[{"name":"Click","assetId":"8162db603a8b0b2cbe623093892d1f97","dataFormat":"wav","rate":48000,"sampleCount":6060,"md5ext":"8162db603a8b0b2cbe623093892d1f97.wav"}],"volume":100,"layerOrder":4,"visible":true,"x":508,"y":-30,"size":200,"direction":90,"draggable":false,"rotationStyle":"all around"}],"monitors":[{"id":"%PW5e$t0ohXOqyC0E~$E","mode":"slider","opcode":"data_variable","params":{"VARIABLE":"Body Color"},"spriteName":null,"value":0,"width":0,"height":0,"x":-400,"y":-175,"visible":true,"sliderMin":0,"sliderMax":200,"isDiscrete":true},{"id":"]tJ;j{`j-u~U+HM|-OP*","mode":"slider","opcode":"data_variable","params":{"VARIABLE":"Body Contrast"},"spriteName":null,"value":0,"width":0,"height":0,"x":-400,"y":-132,"visible":true,"sliderMin":70,"sliderMax":100,"isDiscrete":true},{"id":"5xsG=$qKr=H?9%|qF!.#","mode":"slider","opcode":"data_variable","params":{"VARIABLE":"Eyes Color"},"spriteName":null,"value":0,"width":0,"height":0,"x":743,"y":-171,"visible":true,"sliderMin":0,"sliderMax":200,"isDiscrete":true},{"id":"8L,1TkQ}:c)~*EN{ab{V","mode":"slider","opcode":"data_variable","params":{"VARIABLE":"Eyes Contrast"},"spriteName":null,"value":0,"width":0,"height":0,"x":731,"y":-127,"visible":true,"sliderMin":70,"sliderMax":100,"isDiscrete":true},{"id":"e~-{jKg0MfS`d%e1K{@z","mode":"slider","opcode":"data_variable","params":{"VARIABLE":"Pupil Color"},"spriteName":null,"value":0,"width":0,"height":0,"x":743,"y":-38,"visible":true,"sliderMin":0,"sliderMax":200,"isDiscrete":true},{"id":"Wma,x#poLj.05w6_Foa=","mode":"slider","opcode":"data_variable","params":{"VARIABLE":"Pupil Contrast"},"spriteName":null,"value":0,"width":0,"height":0,"x":730,"y":5,"visible":true,"sliderMin":70,"sliderMax":100,"isDiscrete":true},{"id":"Gi!J}=Ef+H,u%{#xi^Wp","mode":"slider","opcode":"data_variable","params":{"VARIABLE":"Body Brightness"},"spriteName":null,"value":0,"width":0,"height":0,"x":-400,"y":-89,"visible":true,"sliderMin":-65,"sliderMax":0,"isDiscrete":true},{"id":"@p7@CtPn%UpPY-BD6-j!","mode":"slider","opcode":"data_variable","params":{"VARIABLE":"Pupil Brightness"},"spriteName":null,"value":0,"width":0,"height":0,"x":717,"y":49,"visible":true,"sliderMin":-65,"sliderMax":0,"isDiscrete":true},{"id":"C)E0V%|Q^1xT,DIzc%O:","mode":"slider","opcode":"data_variable","params":{"VARIABLE":"Eyes Brightness"},"spriteName":null,"value":0,"width":0,"height":0,"x":718,"y":-83,"visible":true,"sliderMin":-40,"sliderMax":0,"isDiscrete":true},{"id":"|n7veW$La9hD@l|k,gQ^","mode":"slider","opcode":"data_variable","params":{"VARIABLE":"Background Color"},"spriteName":null,"value":0,"width":0,"height":0,"x":-400,"y":-46,"visible":true,"sliderMin":0,"sliderMax":200,"isDiscrete":true},{"id":"L=zp+?]p`L|-6%%I5}Vq","mode":"default","opcode":"data_variable","params":{"VARIABLE":"ResetConfirm?"},"spriteName":null,"value":0,"width":0,"height":0,"x":-395,"y":-3,"visible":false,"sliderMin":0,"sliderMax":100,"isDiscrete":true}],"extensions":["shovelcss","SPlooksExpanded","runtimeoptions","files","lmsLooksPlus"],"extensionURLs":{"shovelcss":"https://extensions.turbowarp.org/TheShovel/CustomStyles.js","SPlooksExpanded":"data:text/javascript;base64,Ly8gTmFtZTogTG9va3MgRXhwYW5kZWQKLy8gSUQ6IFNQbG9va3NFeHBhbmRlZAovLyBEZXNjcmlwdGlvbjogRXhwYW5zaW9uIG9mIHRoZSBMb29rcyBDYXRlZ29yeQovLyBCeTogU2hhcmtQb29sCi8vIEJ5OiBDU1QxMjI5IDxodHRwczovL3NjcmF0Y2gubWl0LmVkdS91c2Vycy9DU1QxMjI5Lz4KLy8gTGljZW5jZTogTUlUCgovLyBWZXJzaW9uIFYuMS4wLjIyCgooZnVuY3Rpb24gKFNjcmF0Y2gpIHsKICAidXNlIHN0cmljdCI7CiAgaWYgKCFTY3JhdGNoLmV4dGVuc2lvbnMudW5zYW5kYm94ZWQpIHRocm93IG5ldyBFcnJvcigiTG9va3MgRXhwYW5kZWQgbXVzdCBydW4gdW5zYW5kYm94ZWQhIik7CgogIGNvbnN0IG1lbnVJY29uVVJJID0KImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJNU55NDNNemtpSUdobGFXZG9kRDBpT1RjdU56TTVJaUIyYVdWM1FtOTRQU0l3SURBZ09UY3VOek01SURrM0xqY3pPU0krUEdjZ2MzUnliMnRsTFcxcGRHVnliR2x0YVhROUlqRXdJajQ4Y0dGMGFDQmtQU0pOTUNBME9DNDROME13SURJeExqZzRJREl4TGpnNElEQWdORGd1T0RjZ01ITTBPQzQ0TnlBeU1TNDRPQ0EwT0M0NE55QTBPQzQ0TnkweU1TNDRPQ0EwT0M0NE55MDBPQzQ0TnlBME9DNDROMU13SURjMUxqZzJJREFnTkRndU9EY2lJR1pwYkd3OUlpTTJNelF5WVRZaUx6NDhjR0YwYUNCa1BTSk5OUzQzT0RJZ05EZ3VPRGRqTUMweU15NDNPVGNnTVRrdU1qa3hMVFF6TGpBNE9DQTBNeTR3T0RndE5ETXVNRGc0VXpreExqazFPQ0F5TlM0d056TWdPVEV1T1RVNElEUTRMamczSURjeUxqWTJOeUE1TVM0NU5UZ2dORGd1T0RjZ09URXVPVFU0SURVdU56Z3lJRGN5TGpZMk55QTFMamM0TWlBME9DNDROeUlnWm1sc2JEMGlJemsyWmlJdlBqeHdZWFJvSUdROUlrMHhOaTR4T0RZZ05EUXVPVGsyWXpRdU5UTXlMVFV1TXpFZ01UWXVNakU0TFRFMkxqZzNOQ0F6TWk0eE56WXRNVGN1TURNMElERTNMakV4TnkwdU1UY3lJREk1TGpNek5DQXhNaTQxTXprZ016TXVOVElnTVRjdU5qQTBJREV1TURNNUlERXVNalU0SURFdU1TQXlMamMyTkM0eE5qY2dNeTQ1TWpjdE15NDVNelVnTkM0NU1ERXRNVFV1T0RrNElERTNMalk0TWkwek15NDJPRGNnTVRjdU56WTNMVEUyTGprMU5pNHdPQzB5T0M0M015MHhNaTQxT1Mwek1pNDNNell0TVRjdU5qSTBMUzQ1T1RNdE1TNHlORGN0TGpjNU15MHpMakExTkM0MU5pMDBMalkwSWlCbWFXeHNQU0lqWm1abUlpOCtQSEJoZEdnZ1pEMGlUVE0xTGpFME5pQTBOeTQyTVdNd0xUY3VOVE0ySURZdU1URXRNVE11TmpRMUlERXpMalkwTlMweE15NDJORFVnTnk0MU16WWdNQ0F4TXk0Mk5EVWdOaTR4TVNBeE15NDJORFVnTVRNdU5qUTFJREFnTnk0MU16WXROaTR4TVNBeE15NDJORFV0TVRNdU5qUTFJREV6TGpZME5TMDNMalV6TmlBd0xURXpMalkwTlMwMkxqRXhMVEV6TGpZME5TMHhNeTQyTkRVaUlHWnBiR3c5SWlNNU5tWWlMejQ4Y0dGMGFDQmtQU0pOTkRFdU16UXlJRFEzTGpZeFlUY3VORFE1SURjdU5EUTVJREFnTVNBeElERTBMamc1T0NBd0lEY3VORFE1SURjdU5EUTVJREFnTUNBeExURTBMamc1T0NBd0lpQm1hV3hzUFNJalptWm1JaTgrUEhCaGRHZ2daRDBpVFRZMUxqWTFJRGM0TGpjNVlUSXVPVElnTWk0NU1pQXdJREFnTVMweUxqa3hPQzB5TGpreWRpMDJMamN4TW1ndE5pNDNNVE5oTWk0NU1pQXlMamt5SURBZ01DQXhMVEl1T1RFNUxUSXVPVEU1VmpZMExqQTFZVEl1T1RJZ01pNDVNaUF3SURBZ01TQXlMamt4T1MweUxqa3hPR2cyTGpjeE0zWXROaTQzTVROQk1pNDVNaUF5TGpreUlEQWdNQ0F4SURZMUxqWTFJRFV4TGpWb01pNHhPV0V5TGpreUlESXVPVElnTUNBd0lERWdNaTQ1TVRnZ01pNDVNVGwyTmk0M01UTm9OaTQzTVROaE1pNDVNaUF5TGpreUlEQWdNQ0F4SURJdU9URTVJREl1T1RFNGRqSXVNVGxoTWk0NU1pQXlMamt5SURBZ01DQXhMVEl1T1RJZ01pNDVNVGhvTFRZdU56RXlkall1TnpFellUSXVPVElnTWk0NU1pQXdJREFnTVMweUxqa3hPU0F5TGpreE9Yb2lJR1pwYkd3OUlpTm1abVlpSUhOMGNtOXJaVDBpSXprMlppSWdjM1J5YjJ0bExYZHBaSFJvUFNJNElpOCtQSEJoZEdnZ1pEMGlUVFkxTGpZMUlEYzRMamM1WVRJdU9USWdNaTQ1TWlBd0lEQWdNUzB5TGpreE9DMHlMamt5ZGkwMkxqY3hNbWd0Tmk0M01UTmhNaTQ1TWlBeUxqa3lJREFnTUNBeExUSXVPVEU1TFRJdU9URTVWalkwTGpBMVlUSXVPVElnTWk0NU1pQXdJREFnTVNBeUxqa3hPUzB5TGpreE9HZzJMamN4TTNZdE5pNDNNVE5CTWk0NU1pQXlMamt5SURBZ01DQXhJRFkxTGpZMUlEVXhMalZvTWk0eE9XRXlMamt5SURJdU9USWdNQ0F3SURFZ01pNDVNVGdnTWk0NU1UbDJOaTQzTVROb05pNDNNVE5oTWk0NU1pQXlMamt5SURBZ01DQXhJREl1T1RFNUlESXVPVEU0ZGpJdU1UbGhNaTQ1TWlBeUxqa3lJREFnTUNBeExUSXVPVElnTWk0NU1UaG9MVFl1TnpFeWRqWXVOekV6WVRJdU9USWdNaTQ1TWlBd0lEQWdNUzB5TGpreE9TQXlMamt4T1hvaUlHWnBiR3c5SWlObVptWWlMejQ4TDJjK1BDOXpkbWMrIjsKCiAgY29uc3Qgdm0gPSBTY3JhdGNoLnZtOwogIGNvbnN0IENhc3QgPSBTY3JhdGNoLkNhc3Q7CiAgY29uc3QgcnVudGltZSA9IHZtLnJ1bnRpbWU7CiAgY29uc3QgbG9va3NDb3JlID0gcnVudGltZS5leHRfc2NyYXRjaDNfbG9va3M7CiAgY29uc3QgaXNQTSA9IFNjcmF0Y2guZXh0ZW5zaW9ucy5pc1Blbmd1aW5Nb2Q7CgogIGNvbnN0IHJlbmRlciA9IHZtLnJlbmRlcmVyOwogIGNvbnN0IHR3Z2wgPSByZW5kZXIuZXhwb3J0cy50d2dsOwogIGNvbnN0IGRyYXdhYmxlS2V5ID0gU3ltYm9sKCJTUGxvb2tzS2V5Iik7CiAgY29uc3QgbmV3VW5pZm9ybXMgPSBbCiAgICAidV9yZXBsYWNlQ29sb3JGcm9tU1AiLCAidV9yZXBsYWNlQ29sb3JUb1NQIiwgInVfcmVwbGFjZVRocmVzaG9sZFNQIiwgInVfbnVtUmVwbGFjZXJzU1AiLAogICAgInVfd2FycFNQIiwgInVfbWFza1RleHR1cmVTUCIsICJ1X3Nob3VsZE1hc2tTUCIsCiAgICAidV90aW50Q29sb3JTUCIsICJ1X3NhdHVyYXRlU1AiLCAidV9vcGFxdWVTUCIsICJ1X2NvbnRyYXN0U1AiLAogICAgInVfcG9zdGVyaXplU1AiLCAidV9zZXBpYVNQIiwgInVfYmxvb21TUCIKICBdOwogIGNvbnN0IGRlZmF1bHROZXdFZmZlY3RzID0gewogICAgd2FycDogWzAuNSwgLTAuNSwgLTAuNSwgLTAuNSwgLTAuNSwgMC41LCAwLjUsIDAuNV0sCiAgICB0aW50OiBbMSwgMSwgMSwgMV0sCiAgICByZXBsYWNlcnM6IFtdLAogICAgbWFza1RleHR1cmU6ICIiLAogICAgb2xkTWFzazogIiIsCiAgICBzaG91bGRNYXNrOiAwLAogICAgbmV3RWZmZWN0czogewogICAgICBzYXR1cmF0aW9uOiAxLCBvcGFxdWU6IDAsIGNvbnRyYXN0OiAxLAogICAgICBwb3N0ZXJpemU6IDAsIHNlcGlhOiAwLCBibG9vbTogMAogICAgfQogIH07CgogIC8qIHBhdGNoIGZvciBuZXcgZWZmZWN0cyAqLwogIGZ1bmN0aW9uIGluaXREcmF3YWJsZShkcmF3YWJsZSkgewogICAgaWYgKCFkcmF3YWJsZVtkcmF3YWJsZUtleV0pIGRyYXdhYmxlW2RyYXdhYmxlS2V5XSA9IHN0cnVjdHVyZWRDbG9uZShkZWZhdWx0TmV3RWZmZWN0cyk7CiAgfQoKICBjb25zdCBvZ0dldFNoYWRlciA9IHJlbmRlci5fc2hhZGVyTWFuYWdlci5nZXRTaGFkZXI7CiAgcmVuZGVyLl9zaGFkZXJNYW5hZ2VyLmdldFNoYWRlciA9IGZ1bmN0aW9uIChkcmF3TW9kZSwgZWZmZWN0Qml0cykgewogICAgY29uc3Qgc2hhZGVyID0gb2dHZXRTaGFkZXIuY2FsbCh0aGlzLCBkcmF3TW9kZSwgZWZmZWN0Qml0cyk7CiAgICBjb25zdCBnbCA9IHJlbmRlci5fZ2w7CgogICAgLy8gYWRkIHVuaWZvcm1zIHRvIHRoZSBleGlzdGluZyBzaGFkZXIKICAgIG5ld1VuaWZvcm1zLmZvckVhY2gobmFtZSA9PiB7CiAgICAgIHNoYWRlci51bmlmb3JtU2V0dGVyc1tuYW1lXSA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihzaGFkZXIucHJvZ3JhbSwgbmFtZSk7CiAgICB9KTsKICAgIHJldHVybiBzaGFkZXI7CiAgfTsKCiAgLy8gQ2xlYXIgdGhlIHJlbmRlcmVyInMgc2hhZGVyIGNhY2hlIHNpbmNlIHdlInJlIHBhdGNoaW5nIHNoYWRlcnMKICBmb3IgKGNvbnN0IGNhY2hlIG9mIE9iamVjdC52YWx1ZXMocmVuZGVyLl9zaGFkZXJNYW5hZ2VyLl9zaGFkZXJDYWNoZSkpIHsKICAgIGZvciAoY29uc3QgcHJvZ3JhbUluZm8gb2YgY2FjaGUpIHsKICAgICAgaWYgKHByb2dyYW1JbmZvKSByZW5kZXIuZ2wuZGVsZXRlUHJvZ3JhbShwcm9ncmFtSW5mby5wcm9ncmFtKTsKICAgIH0KICAgIGNhY2hlLmxlbmd0aCA9IDA7CiAgfQoKICBsZXQgcGF0Y2hTaGFkZXJzID0gZmFsc2U7CiAgY29uc3Qgb2dDcmVhdGVQcm9ncmFtSW5mbyA9IHR3Z2wuY3JlYXRlUHJvZ3JhbUluZm87CiAgdHdnbC5jcmVhdGVQcm9ncmFtSW5mbyA9IGZ1bmN0aW9uICguLi5hcmdzKSB7CiAgICAvLyBwZXJmb3JtIGEgc3RyaW5nIGZpbmQtYW5kLXJlcGxhY2Ugb24gdGhlIHNoYWRlciB0ZXh0CiAgICBpZiAocGF0Y2hTaGFkZXJzICYmIGFyZ3NbMV0gJiYgYXJnc1sxXVswXSAmJiBhcmdzWzFdWzFdKSB7CiAgICAgIGFyZ3NbMV1bMF0gPSBhcmdzWzFdWzBdCiAgICAgICAgLy8gcmVwbGFjZSBhdHRyaWJ1dGUgcHJvcGVydGllcyB3aXRoIHZhcmlhYmxlcyB3ZSBjYW4gbW9kaWZ5CiAgICAgICAgLnJlcGxhY2VBbGwoInZlYzQoYV9wb3NpdGlvbiIsICJ2ZWM0KHBvc2l0aW9uU1AiKQogICAgICAgIC5yZXBsYWNlKCJ2X3RleENvb3JkID0gYV90ZXhDb29yZDsiLCAiIikKICAgICAgICAucmVwbGFjZSgiI2lmICEoZGVmaW5lZChEUkFXX01PREVfbGluZSkgfHwgZGVmaW5lZChEUkFXX01PREVfYmFja2dyb3VuZCkpIiwgIiNpZiAxIikKICAgICAgICAucmVwbGFjZSgKICAgICAgICBgdm9pZCBtYWluKCkge2AsCiAgICAgICAgYHVuaWZvcm0gdmVjMiB1X3dhcnBTUFs0XTsKCnZvaWQgbWFpbigpIHsKICB2ZWMyIHBvc2l0aW9uU1AgPSBhX3Bvc2l0aW9uOwogICNpZm5kZWYgRFJBV19NT0RFX2JhY2tncm91bmQKICB2X3RleENvb3JkID0gYV90ZXhDb29yZDsKICAjZW5kaWYKCiAgZmxvYXQgdSA9IHZfdGV4Q29vcmQueDsKICBmbG9hdCB2ID0gdl90ZXhDb29yZC55OwoKICAvLyBhcHBseSBwb3NpdGlvbiB3YXJwIChiaWxpbmVhcikKICB2ZWMyIHdhcnBlZFBvcyA9IAogICAgKDEuMCAtIHUpICogKDEuMCAtIHYpICogdV93YXJwU1BbMF0gKyB1ICogKDEuMCAtIHYpICogdV93YXJwU1BbMV0gKwogICAgdSAqIHYgKiB1X3dhcnBTUFsyXSArICgxLjAgLSB1KSAqIHYgKiB1X3dhcnBTUFszXTsKCiAgLy8gY29tcHV0ZSB3IGZvciBwZXJzcGVjdGl2ZSBjb3JyZWN0aW9uCiAgZmxvYXQgdyA9ICgxLjAgLSB1KSAqICgxLjAgLSB2KSArIHUgKiAoMS4wIC0gdikgKyB1ICogdiArICgxLjAgLSB1KSAqIHY7CgogIHBvc2l0aW9uU1AgPSB3YXJwZWRQb3MgLyBtYXgodywgMWUtNSk7CgogICNpZmRlZiBEUkFXX01PREVfYmFja2dyb3VuZAogIGdsX1Bvc2l0aW9uID0gdmVjNChwb3NpdGlvblNQICogMi4wLCAwLCAxKTsKICAjZWxzZQogIGdsX1Bvc2l0aW9uID0gdV9wcm9qZWN0aW9uTWF0cml4ICogdV9tb2RlbE1hdHJpeCAqIHZlYzQocG9zaXRpb25TUCwgMCwgMSk7CiAgI2VuZGlmYAogICAgICApOwoKICAgICAgYXJnc1sxXVsxXSA9IGFyZ3NbMV1bMV0ucmVwbGFjZSgKICAgICAgICBgdW5pZm9ybSBzYW1wbGVyMkQgdV9za2luO2AsCiAgICAgICAgYHVuaWZvcm0gc2FtcGxlcjJEIHVfc2tpbjsKdW5pZm9ybSBzYW1wbGVyMkQgdV9tYXNrVGV4dHVyZVNQOwp1bmlmb3JtIGZsb2F0IHVfc2hvdWxkTWFza1NQOwoKI2RlZmluZSBNQVhfUkVQTEFDRVJTIDE1CnVuaWZvcm0gdmVjMyB1X3JlcGxhY2VDb2xvckZyb21TUFtNQVhfUkVQTEFDRVJTXTsKdW5pZm9ybSB2ZWM0IHVfcmVwbGFjZUNvbG9yVG9TUFtNQVhfUkVQTEFDRVJTXTsKdW5pZm9ybSBmbG9hdCB1X3JlcGxhY2VUaHJlc2hvbGRTUFtNQVhfUkVQTEFDRVJTXTsKdW5pZm9ybSBpbnQgdV9udW1SZXBsYWNlcnNTUDsKCnVuaWZvcm0gdmVjNCB1X3RpbnRDb2xvclNQOwp1bmlmb3JtIGZsb2F0IHVfc2F0dXJhdGVTUDsKdW5pZm9ybSBmbG9hdCB1X29wYXF1ZVNQOwp1bmlmb3JtIGZsb2F0IHVfY29udHJhc3RTUDsKdW5pZm9ybSBmbG9hdCB1X3Bvc3Rlcml6ZVNQOwp1bmlmb3JtIGZsb2F0IHVfc2VwaWFTUDsKdW5pZm9ybSBmbG9hdCB1X2Jsb29tU1A7Cgp2ZWMzIHNwUkdCMkhTVih2ZWMzIGMpIHsKICB2ZWM0IEsgPSB2ZWM0KDAuMCwgLTEuMCAvIDMuMCwgMi4wIC8gMy4wLCAtMS4wKTsKICB2ZWM0IHAgPSBtaXgodmVjNChjLmJnLCBLLnd6KSwgdmVjNChjLmdiLCBLLnh5KSwgc3RlcChjLmIsIGMuZykpOwogIHZlYzQgcSA9IG1peCh2ZWM0KHAueHl3LCBjLnIpLCB2ZWM0KGMuciwgcC55engpLCBzdGVwKHAueCwgYy5yKSk7CgogIGZsb2F0IGQgPSBxLnggLSBtaW4ocS53LCBxLnkpOwogIGZsb2F0IGUgPSAxLjBlLTEwOwogIHJldHVybiB2ZWMzKGFicyhxLnogKyAocS53IC0gcS55KSAvICg2LjAgKiBkICsgZSkpLCBkIC8gKHEueCArIGUpLCBxLngpOwp9CnZlYzMgc3BIU1YyUkdCKHZlYzMgYykgewogIHZlYzQgSyA9IHZlYzQoMS4wLCAyLjAgLyAzLjAsIDEuMCAvIDMuMCwgMy4wKTsKICB2ZWMzIHAgPSBhYnMoZnJhY3QoYy54eHggKyBLLnh5eikgKiA2LjAgLSBLLnd3dyk7CiAgcmV0dXJuIGMueiAqIG1peChLLnh4eCwgY2xhbXAocCAtIEsueHh4LCAwLjAsIDEuMCksIGMueSk7Cn1gCiAgICAgICkucmVwbGFjZSgKICAgICAgICBgZ2xfRnJhZ0NvbG9yLnJnYiA9IGNsYW1wKGdsX0ZyYWdDb2xvci5yZ2IgLyAoZ2xfRnJhZ0NvbG9yLmEgKyBlcHNpbG9uKSwgMC4wLCAxLjApO2AsCiAgICAgICAgYGdsX0ZyYWdDb2xvci5yZ2IgPSBjbGFtcChnbF9GcmFnQ29sb3IucmdiIC8gKGdsX0ZyYWdDb2xvci5hICsgZXBzaWxvbiksIDAuMCwgMS4wKTsKdmVjMyBmaW5hbENvbG9yID0gZ2xfRnJhZ0NvbG9yLnJnYjsKZmxvYXQgZmluYWxBbHBoYSA9IGdsX0ZyYWdDb2xvci5hOwoKaWYgKHVfc2hvdWxkTWFza1NQID4gMC41ICYmIGZpbmFsQWxwaGEgPiAwLjApIHsKICB2ZWM0IG1hc2tDb2xvciA9IHRleHR1cmUyRCh1X21hc2tUZXh0dXJlU1AsIHRleGNvb3JkMCk7CiAgbWFza0NvbG9yLnJnYiA9IGNsYW1wKG1hc2tDb2xvci5yZ2IgLyAobWFza0NvbG9yLmEgKyBlcHNpbG9uKSwgMC4wLCAxLjApOwogIGZpbmFsQWxwaGEgKj0gbWFza0NvbG9yLmE7Cn0KCmZvciAoaW50IGkgPSAwOyBpIDwgTUFYX1JFUExBQ0VSUzsgaSsrKSB7CiAgaWYgKGkgPj0gdV9udW1SZXBsYWNlcnNTUCkgYnJlYWs7CgogIGZsb2F0IGRpc3QgPSBkaXN0YW5jZShmaW5hbENvbG9yLCB1X3JlcGxhY2VDb2xvckZyb21TUFtpXSk7CiAgaWYgKGRpc3QgPD0gdV9yZXBsYWNlVGhyZXNob2xkU1BbaV0pIHsKICAgIGZsb2F0IHN0cmVuZ3RoID0gMS4wIC0gKGRpc3QgLyAodV9yZXBsYWNlVGhyZXNob2xkU1BbaV0gKyAxLjApKTsKICAgIGZpbmFsQ29sb3IgPSBtaXgoZmluYWxDb2xvciwgdV9yZXBsYWNlQ29sb3JUb1NQW2ldLnJnYiwgc3RyZW5ndGgpOwogICAgaWYgKHVfcmVwbGFjZUNvbG9yVG9TUFtpXS5hIDwgMS4wICYmIHN0cmVuZ3RoID4gMC4wMSkgewogICAgICBmaW5hbEFscGhhID0gY2xhbXAobWl4KGZpbmFsQWxwaGEsIHVfcmVwbGFjZUNvbG9yVG9TUFtpXS5hLCBzdHJlbmd0aCksIDAuMCwgMS4wKTsKICAgIH0KICB9Cn0KCnZlYzMgaHN2ID0gc3BSR0IySFNWKGZpbmFsQ29sb3IpOwppZiAodV9zYXR1cmF0ZVNQIDwgMC4wKSB7CiAgaHN2LnggPSBtb2QoaHN2LnggKyAwLjUsIDEuMCk7CiAgaHN2LnkgKj0gLXVfc2F0dXJhdGVTUDsKfSBlbHNlIHsKICBoc3YueSAqPSB1X3NhdHVyYXRlU1A7Cn0KZmluYWxDb2xvciA9IHNwSFNWMlJHQihoc3YpOwpmaW5hbENvbG9yID0gKGZpbmFsQ29sb3IgLSAwLjUpICogdV9jb250cmFzdFNQICsgMC41OwppZiAodV9wb3N0ZXJpemVTUCA+IDAuMCkgZmluYWxDb2xvciA9IGZsb29yKGZpbmFsQ29sb3IgKiB1X3Bvc3Rlcml6ZVNQKSAvIHVfcG9zdGVyaXplU1A7CgppZiAodV9zZXBpYVNQID4gMC4wKSB7CiAgdmVjMyBzZXBpYUNvbG9yID0gdmVjMygKICAgIGRvdChmaW5hbENvbG9yLCB2ZWMzKDAuMzkzLCAwLjc2OSwgMC4xODkpKSwKICAgIGRvdChmaW5hbENvbG9yLCB2ZWMzKDAuMzQ5LCAwLjY4NiwgMC4xNjgpKSwKICAgIGRvdChmaW5hbENvbG9yLCB2ZWMzKDAuMjcyLCAwLjUzNCwgMC4xMzEpKQogICk7CiAgZmluYWxDb2xvciA9IG1peChmaW5hbENvbG9yLCBzZXBpYUNvbG9yLCB1X3NlcGlhU1ApOwp9CmlmICh1X2Jsb29tU1AgPiAwLjApIHsKICB2ZWMzIGJsb29tID0gbWF4KGZpbmFsQ29sb3IgLSAwLjQsIDAuMCk7CgogIGJsb29tICs9IHRleHR1cmUyRCh1X3NraW4sIHZfdGV4Q29vcmQgKyB2ZWMyKCAwLjAwMSwgIDAuMDAxKSkucmdiOwogIGJsb29tICs9IHRleHR1cmUyRCh1X3NraW4sIHZfdGV4Q29vcmQgKyB2ZWMyKC0wLjAwMSwgIDAuMDAxKSkucmdiOwogIGJsb29tICs9IHRleHR1cmUyRCh1X3NraW4sIHZfdGV4Q29vcmQgKyB2ZWMyKCAwLjAwMSwgLTAuMDAxKSkucmdiOwogIGJsb29tICs9IHRleHR1cmUyRCh1X3NraW4sIHZfdGV4Q29vcmQgKyB2ZWMyKC0wLjAwMSwgLTAuMDAxKSkucmdiOwogIGJsb29tICo9IDAuMjU7CgogIGZpbmFsQ29sb3IgKz0gYmxvb20gKiB1X2Jsb29tU1A7CiAgZmluYWxDb2xvciA9IGNsYW1wKGZpbmFsQ29sb3IsIDAuMCwgMS4wKTsKfQoKZ2xfRnJhZ0NvbG9yLnJnYiA9IGZpbmFsQ29sb3IgKiB1X3RpbnRDb2xvclNQLnJnYjsKZmxvYXQgYmFzZUFscGhhID0gZmluYWxBbHBoYTsKaWYgKGJhc2VBbHBoYSA+IDAuMCAmJiBiYXNlQWxwaGEgPCAxLjApIGJhc2VBbHBoYSA9IG1peChiYXNlQWxwaGEsIDEuMCwgdV9vcGFxdWVTUCk7CmdsX0ZyYWdDb2xvci5hID0gYmFzZUFscGhhO2AKICAgICAgKS5yZXBsYWNlQWxsKAogICAgICAgIC8vIFRoZSB1bnByZW11bHRpcGx5IGNvZGUgd2lsbCBub3cgYWx3YXlzIHJ1biBkdWUgdG8gcGFsZXR0ZSByZXBsYWNlbWVudCBzdHVmZi4KICAgICAgICAvLyBUaGlzIGlzIGEgYml0IG1vcmUgaW5lZmZpY2llbnQsIGJ1dCB3aGF0ZXZlci4KICAgICAgICAiI2lmIGRlZmluZWQoRU5BQkxFX2NvbG9yKSB8fCBkZWZpbmVkKEVOQUJMRV9icmlnaHRuZXNzKSIsCiAgICAgICAgLy8gaSBoYXZlIG5vIGlkZWEgaG93IHdlYmdsIHdvcmtzLCBhbmQgaSBkb24idCB3YW50IHRvIGhhdmUgdG8gcmVtb3ZlIHRoZSAjZW5kaWYgc29tZWhvdwogICAgICAgIC8vIGp1c3QgZG8gc29tZXRoaW5nIHRoYXQgd2lsbCBhbHdheXMgYmUgdHJ1ZSAtQ1NUCiAgICAgICAgIiNpZiBkZWZpbmVkKE1BWF9SRVBMQUNFUlMpIgogICAgICApOwogICAgfQogICAgcmV0dXJuIG9nQ3JlYXRlUHJvZ3JhbUluZm8uYXBwbHkodGhpcywgYXJncyk7CiAgfTsKICBjb25zdCBvZ0J1aWxkU2hhZGVyID0gcmVuZGVyLl9zaGFkZXJNYW5hZ2VyLl9idWlsZFNoYWRlcjsKICByZW5kZXIuX3NoYWRlck1hbmFnZXIuX2J1aWxkU2hhZGVyID0gZnVuY3Rpb24gKC4uLmFyZ3MpIHsKICAgIHRyeSB7CiAgICAgIHBhdGNoU2hhZGVycyA9IHRydWU7CiAgICAgIHJldHVybiBvZ0J1aWxkU2hhZGVyLmFwcGx5KHRoaXMsIGFyZ3MpOwogICAgfSBmaW5hbGx5IHsKICAgICAgcGF0Y2hTaGFkZXJzID0gZmFsc2U7CiAgICB9CiAgfTsKCiAgY29uc3QgTUFYX1JFUExBQ0VSUyA9IDE1OwogIC8vIENsaXBwaW5nIGFuZCBCbGVuZGluZyBTdXBwb3J0CiAgbGV0IHRvQ29ycmVjdFRoaW5nID0gbnVsbCwgYWN0aXZlID0gZmFsc2UsIGZsaXBZID0gZmFsc2U7CiAgY29uc3QgY2FudmFzID0gcmVuZGVyLmNhbnZhczsKICBsZXQgd2lkdGggPSAwLCBoZWlnaHQgPSAwOwogIGxldCBzY3JhdGNoVW5pdFdpZHRoID0gNDgwLCBzY3JhdGNoVW5pdEhlaWdodCA9IDM2MDsKCiAgcmVuZGVyLl9kcmF3VGhlc2UgPSBmdW5jdGlvbiAoZHJhd2FibGVzLCBkcmF3TW9kZSwgcHJvamVjdGlvbiwgb3B0cyA9IHt9KSB7CiAgICAvLyBDbGlwcGluZyBhbmQgQmxlbmRpbmcgU3VwcG9ydAogICAgYWN0aXZlID0gdHJ1ZTsKICAgIFtzY3JhdGNoVW5pdFdpZHRoLCBzY3JhdGNoVW5pdEhlaWdodF0gPSByZW5kZXIuZ2V0TmF0aXZlU2l6ZSgpOwoKICAgIGNvbnN0IGdsID0gcmVuZGVyLl9nbDsKICAgIGxldCBjdXJyZW50U2hhZGVyID0gbnVsbDsKCiAgICBjb25zdCBmcmFtZWJ1ZmZlclNwYWNlU2NhbGVEaWZmZXJzID0gKAogICAgICAiZnJhbWVidWZmZXJXaWR0aCIgaW4gb3B0cyAmJiAiZnJhbWVidWZmZXJIZWlnaHQiIGluIG9wdHMgJiYKICAgICAgb3B0cy5mcmFtZWJ1ZmZlcldpZHRoICE9PSByZW5kZXIuX25hdGl2ZVNpemVbMF0gJiYgb3B0cy5mcmFtZWJ1ZmZlckhlaWdodCAhPT0gcmVuZGVyLl9uYXRpdmVTaXplWzFdCiAgICApOwoKICAgIGNvbnN0IG51bURyYXdhYmxlcyA9IGRyYXdhYmxlcy5sZW5ndGg7CiAgICBmb3IgKGxldCBkcmF3YWJsZUluZGV4ID0gMDsgZHJhd2FibGVJbmRleCA8IG51bURyYXdhYmxlczsgKytkcmF3YWJsZUluZGV4KSB7CiAgICAgIGNvbnN0IGRyYXdhYmxlSUQgPSBkcmF3YWJsZXNbZHJhd2FibGVJbmRleF07CiAgICAgIGlmIChvcHRzLmZpbHRlciAmJiAhb3B0cy5maWx0ZXIoZHJhd2FibGVJRCkpIGNvbnRpbnVlOwoKICAgICAgY29uc3QgZHJhd2FibGUgPSByZW5kZXIuX2FsbERyYXdhYmxlc1tkcmF3YWJsZUlEXTsKICAgICAgaWYgKCFkcmF3YWJsZSB8fCAoIWRyYXdhYmxlLmdldFZpc2libGUoKSAmJiAhb3B0cy5pZ25vcmVWaXNpYmlsaXR5KSkgY29udGludWU7CgogICAgICBjb25zdCBkcmF3YWJsZVNjYWxlID0gZnJhbWVidWZmZXJTcGFjZVNjYWxlRGlmZmVycyA/IFsKICAgICAgICBkcmF3YWJsZS5zY2FsZVswXSAqIG9wdHMuZnJhbWVidWZmZXJXaWR0aCAvIHJlbmRlci5fbmF0aXZlU2l6ZVswXSwKICAgICAgICBkcmF3YWJsZS5zY2FsZVsxXSAqIG9wdHMuZnJhbWVidWZmZXJIZWlnaHQgLyByZW5kZXIuX25hdGl2ZVNpemVbMV0KICAgICAgXSA6IGRyYXdhYmxlLnNjYWxlOwoKICAgICAgaWYgKCFkcmF3YWJsZS5za2luIHx8ICFkcmF3YWJsZS5za2luLmdldFRleHR1cmUoZHJhd2FibGVTY2FsZSkpIGNvbnRpbnVlOwogICAgICBpZiAob3B0cy5za2lwUHJpdmF0ZVNraW5zICYmIGRyYXdhYmxlLnNraW4ucHJpdmF0ZSkgY29udGludWU7CgogICAgICBjb25zdCB1bmlmb3JtcyA9IHt9OwoKICAgICAgbGV0IGVmZmVjdEJpdHMgPSBkcmF3YWJsZS5lbmFibGVkRWZmZWN0czsKICAgICAgZWZmZWN0Qml0cyAmPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob3B0cywgImVmZmVjdE1hc2siKSA/IG9wdHMuZWZmZWN0TWFzayA6IGVmZmVjdEJpdHM7CiAgICAgIGNvbnN0IG5ld1NoYWRlciA9IHJlbmRlci5fc2hhZGVyTWFuYWdlci5nZXRTaGFkZXIoZHJhd01vZGUsIGVmZmVjdEJpdHMpOwoKICAgICAgaWYgKHJlbmRlci5fcmVnaW9uSWQgIT09IG5ld1NoYWRlcikgewogICAgICAgIHJlbmRlci5fZG9FeGl0RHJhd1JlZ2lvbigpOwogICAgICAgIHJlbmRlci5fcmVnaW9uSWQgPSBuZXdTaGFkZXI7CgogICAgICAgIGN1cnJlbnRTaGFkZXIgPSBuZXdTaGFkZXI7CiAgICAgICAgZ2wudXNlUHJvZ3JhbShjdXJyZW50U2hhZGVyLnByb2dyYW0pOwogICAgICAgIHR3Z2wuc2V0QnVmZmVyc0FuZEF0dHJpYnV0ZXMoZ2wsIGN1cnJlbnRTaGFkZXIsIHJlbmRlci5fYnVmZmVySW5mbyk7CiAgICAgICAgT2JqZWN0LmFzc2lnbih1bmlmb3JtcywgeyB1X3Byb2plY3Rpb25NYXRyaXg6IHByb2plY3Rpb24gfSk7CiAgICAgIH0KCiAgICAgIC8qIGhhbmRsZSBuZXcgZWZmZWN0cyAqLwogICAgICBpbml0RHJhd2FibGUoZHJhd2FibGUpOwogICAgICBjb25zdCBlZmZlY3REYXRhID0gZHJhd2FibGVbZHJhd2FibGVLZXldOwogICAgICBjb25zdCByZXBsYWNlcnMgPSBlZmZlY3REYXRhLnJlcGxhY2VyczsKIAogICAgICBjb25zdCByZXBsYWNlRnJvbSA9IG5ldyBGbG9hdDMyQXJyYXkoTUFYX1JFUExBQ0VSUyAqIDMpLmZpbGwoMCk7CiAgICAgIGNvbnN0IHJlcGxhY2VUbyA9IG5ldyBGbG9hdDMyQXJyYXkoTUFYX1JFUExBQ0VSUyAqIDQpLmZpbGwoMCk7CiAgICAgIGNvbnN0IHJlcGxhY2VUaHJlc2ggPSBuZXcgRmxvYXQzMkFycmF5KE1BWF9SRVBMQUNFUlMpLmZpbGwoMSk7CiAgICAgIGlmIChyZXBsYWNlcnMubGVuZ3RoID4gMCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTWF0aC5taW4ocmVwbGFjZXJzLmxlbmd0aCwgTUFYX1JFUExBQ0VSUyk7IGkrKykgewogICAgICAgICAgcmVwbGFjZUZyb20uc2V0KHJlcGxhY2Vyc1tpXS50YXJnZXRWZXJ0LCBpICogMyk7CiAgICAgICAgICByZXBsYWNlVG8uc2V0KHJlcGxhY2Vyc1tpXS5yZXBsYWNlVmVydCwgaSAqIDQpOwogICAgICAgICAgcmVwbGFjZVRocmVzaFtpXSA9IHJlcGxhY2Vyc1tpXS5zb2Z0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGVmZmVjdERhdGEuc2hvdWxkTWFzaykgewogICAgICAgIGdsLmFjdGl2ZVRleHR1cmUoZ2wuVEVYVFVSRTMwKTsKICAgICAgICBnbC5iaW5kVGV4dHVyZShnbC5URVhUVVJFXzJELCBlZmZlY3REYXRhLl9tYXNrVGV4dHVyZSk7CiAgICAgICAgZ2wudW5pZm9ybTFpKGN1cnJlbnRTaGFkZXIudW5pZm9ybVNldHRlcnNbInVfbWFza1RleHR1cmVTUCJdLCAzMCk7CiAgICAgICAgZ2wuYWN0aXZlVGV4dHVyZShnbC5URVhUVVJFMCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5ld1VuaWZvcm1TZXR0ZXJzID0gewogICAgICAgIHVfcmVwbGFjZUNvbG9yRnJvbVNQOiB7IG1ldGhvZDogInVuaWZvcm0zZnYiLCB2YWx1ZTogcmVwbGFjZUZyb20gfSwKICAgICAgICB1X3JlcGxhY2VDb2xvclRvU1A6IHsgbWV0aG9kOiAidW5pZm9ybTRmdiIsIHZhbHVlOiByZXBsYWNlVG8gfSwKICAgICAgICB1X3JlcGxhY2VUaHJlc2hvbGRTUDogeyBtZXRob2Q6ICJ1bmlmb3JtMWZ2IiwgdmFsdWU6IHJlcGxhY2VUaHJlc2ggfSwKICAgICAgICB1X251bVJlcGxhY2Vyc1NQOiB7IG1ldGhvZDogInVuaWZvcm0xaSIsIHZhbHVlOiByZXBsYWNlcnMgPyBNYXRoLm1pbihyZXBsYWNlcnMubGVuZ3RoLCBNQVhfUkVQTEFDRVJTKSA6IDAgfSwKICAgICAgICB1X3RpbnRDb2xvclNQOiB7IG1ldGhvZDogInVuaWZvcm00ZnYiLCB2YWx1ZTogZWZmZWN0RGF0YS50aW50IH0sCiAgICAgICAgdV93YXJwU1A6IHsgbWV0aG9kOiAidW5pZm9ybTJmdiIsIHZhbHVlOiBlZmZlY3REYXRhLndhcnAgfSwKICAgICAgICB1X3Nob3VsZE1hc2tTUDogeyBtZXRob2Q6ICJ1bmlmb3JtMWYiLCB2YWx1ZTogZWZmZWN0RGF0YS5zaG91bGRNYXNrIH0sCiAgICAgICAgdV9zYXR1cmF0ZVNQOiB7IG1ldGhvZDogInVuaWZvcm0xZiIsIHZhbHVlOiBlZmZlY3REYXRhLm5ld0VmZmVjdHMuc2F0dXJhdGlvbiB9LAogICAgICAgIHVfb3BhcXVlU1A6IHsgbWV0aG9kOiAidW5pZm9ybTFmIiwgdmFsdWU6IGVmZmVjdERhdGEubmV3RWZmZWN0cy5vcGFxdWUgfSwKICAgICAgICB1X2NvbnRyYXN0U1A6IHsgbWV0aG9kOiAidW5pZm9ybTFmIiwgdmFsdWU6IGVmZmVjdERhdGEubmV3RWZmZWN0cy5jb250cmFzdCB9LAogICAgICAgIHVfcG9zdGVyaXplU1A6IHsgbWV0aG9kOiAidW5pZm9ybTFmIiwgdmFsdWU6IGVmZmVjdERhdGEubmV3RWZmZWN0cy5wb3N0ZXJpemUgfSwKICAgICAgICB1X3NlcGlhU1A6IHsgbWV0aG9kOiAidW5pZm9ybTFmIiwgdmFsdWU6IGVmZmVjdERhdGEubmV3RWZmZWN0cy5zZXBpYSB9LAogICAgICAgIHVfYmxvb21TUDogeyBtZXRob2Q6ICJ1bmlmb3JtMWYiLCB2YWx1ZTogZWZmZWN0RGF0YS5uZXdFZmZlY3RzLmJsb29tIH0KICAgICAgfTsKCiAgICAgIE9iamVjdC5lbnRyaWVzKG5ld1VuaWZvcm1TZXR0ZXJzKS5mb3JFYWNoKChba2V5LCB7IG1ldGhvZCwgdmFsdWUgfV0pID0+IHsKICAgICAgICBpZiAoY3VycmVudFNoYWRlci51bmlmb3JtU2V0dGVyc1trZXldKSBnbFttZXRob2RdKGN1cnJlbnRTaGFkZXIudW5pZm9ybVNldHRlcnNba2V5XSwgdmFsdWUpOwogICAgICB9KTsKICAgICAgLyogZW5kIG9mIG5ldyBlZmZlY3RzICovCgogICAgICBPYmplY3QuYXNzaWduKHVuaWZvcm1zLCBkcmF3YWJsZS5za2luLmdldFVuaWZvcm1zKGRyYXdhYmxlU2NhbGUpLCBkcmF3YWJsZS5nZXRVbmlmb3JtcygpKTsKICAgICAgaWYgKG9wdHMuZXh0cmFVbmlmb3JtcykgT2JqZWN0LmFzc2lnbih1bmlmb3Jtcywgb3B0cy5leHRyYVVuaWZvcm1zKTsKCiAgICAgIGlmICh1bmlmb3Jtcy51X3NraW4pIHsKICAgICAgICB0d2dsLnNldFRleHR1cmVQYXJhbWV0ZXJzKGdsLCB1bmlmb3Jtcy51X3NraW4sIHsgbWluTWFnOiBkcmF3YWJsZS5za2luLnVzZU5lYXJlc3QoZHJhd2FibGVTY2FsZSwgZHJhd2FibGUpID8gZ2wuTkVBUkVTVCA6IGdsLkxJTkVBUiB9KTsKICAgICAgfQoKICAgICAgdHdnbC5zZXRVbmlmb3JtcyhjdXJyZW50U2hhZGVyLCB1bmlmb3Jtcyk7CiAgICAgIHR3Z2wuZHJhd0J1ZmZlckluZm8oZ2wsIHJlbmRlci5fYnVmZmVySW5mbywgZ2wuVFJJQU5HTEVTKTsKICAgIH0KICAgIHJlbmRlci5fcmVnaW9uSWQgPSBudWxsOwoKICAgIC8vIENsaXBwaW5nIGFuZCBCbGVuZGluZyBTdXBwb3J0CiAgICBnbC5kaXNhYmxlKGdsLlNDSVNTT1JfVEVTVCk7CiAgICBnbC5ibGVuZEZ1bmMoZ2wuT05FLCBnbC5PTkVfTUlOVVNfU1JDX0FMUEhBKTsKICAgIGFjdGl2ZSA9IGZhbHNlOwogIH07CgogIC8vIHJlc2V0IG9uIHN0b3Avc3RhcnQvY2xlYXIKICBjb25zdCBvZ0NsZWFyRWZmZWN0cyA9IHZtLmV4cG9ydHMuUmVuZGVyZWRUYXJnZXQucHJvdG90eXBlLmNsZWFyRWZmZWN0czsKICB2bS5leHBvcnRzLlJlbmRlcmVkVGFyZ2V0LnByb3RvdHlwZS5jbGVhckVmZmVjdHMgPSBmdW5jdGlvbigpIHsKICAgIGNvbnN0IGRyYXdhYmxlID0gcmVuZGVyLl9hbGxEcmF3YWJsZXNbdGhpcy5kcmF3YWJsZUlEXTsKICAgIGRyYXdhYmxlW2RyYXdhYmxlS2V5XSA9IHN0cnVjdHVyZWRDbG9uZShkZWZhdWx0TmV3RWZmZWN0cyk7CiAgICBvZ0NsZWFyRWZmZWN0cy5jYWxsKHRoaXMpOwogIH07CgogIC8vIG1hbmlwdWxhdGUgYm91bmRzIGZvciB3YXJwaW5nCiAgY29uc3QgcmFkaWFuQ29udmVydGVyID0gTWF0aC5QSSAvIDE4MDsKICBmdW5jdGlvbiByb3RhdGVQb2ludCh4LCB5LCBjeCwgY3ksIHJhZHMpIHsKICAgIGNvbnN0IGNvcyA9IE1hdGguY29zKHJhZHMpLCBzaW4gPSBNYXRoLnNpbihyYWRzKTsKICAgIGNvbnN0IGR4ID0geCAtIGN4LCBkeSA9IHkgLSBjeTsKICAgIHJldHVybiB7CiAgICAgIHg6IGN4ICsgZHggKiBjb3MgLSBkeSAqIHNpbiwKICAgICAgeTogY3kgKyBkeCAqIHNpbiArIGR5ICogY29zCiAgICB9OwogIH0KICBmdW5jdGlvbiB3YXJwQm91bmRzKGRyYXdhYmxlLCBib3VuZHMpIHsKICAgIGlmICghZHJhd2FibGVbZHJhd2FibGVLZXldKSByZXR1cm4gYm91bmRzOwoKICAgIGxldCB3YXJwVmFscyA9IGRyYXdhYmxlW2RyYXdhYmxlS2V5XS53YXJwOwogICAgaWYgKHdhcnBWYWxzLmpvaW4oIiwiKSA9PT0gZGVmYXVsdE5ld0VmZmVjdHMud2FycC5qb2luKCIsIikpIHJldHVybiBib3VuZHM7CgogICAgLy8gb3JpZ2luYWwgZ2V0Qm91bmRzIGFscmVhZHkgYWNjb3VudHMgZm9yIHJvdGF0aW9uLCBzbyB3ZSBoYXZlIHRvIG1ha2Ugb3VyIG93biBzeXN0ZW0KICAgIC8vIGZvciBnZXR0aW5nIHRoZSBub24tcm90YXRlZCBzY2FsZSBhbmQgcG9zaXRpb24KICAgIHdhcnBWYWxzID0gd2FycFZhbHMubWFwKCh2LCBpKSA9PiBpID4gMCAmJiBpIDwgNSA/IHYgKiAtMSA6IHYpOwogICAgY29uc3QgYW5nbGUgPSAoZHJhd2FibGUuX2RpcmVjdGlvbiAtIDkwKSAqIHJhZGlhbkNvbnZlcnRlcjsKICAgIGNvbnN0IFt4LCB5XSA9IGRyYXdhYmxlLl9wb3NpdGlvbjsKICAgIGNvbnN0IHdpZHRoID0gZHJhd2FibGUuc2tpbi5zaXplWzBdICogKGRyYXdhYmxlLnNjYWxlWzBdIC8gMjAwKTsKICAgIGNvbnN0IGhlaWdodCA9IGRyYXdhYmxlLnNraW4uc2l6ZVsxXSAqIChkcmF3YWJsZS5zY2FsZVsxXSAvIDIwMCk7CgogICAgY29uc3QgcG9pbnRzID0gWwogICAgICB7IHg6ICh3YXJwVmFsc1swXSAqIDIpICogLXdpZHRoICsgeCwgeTogKHdhcnBWYWxzWzFdICogLTIpICogaGVpZ2h0IC0geSB9LAogICAgICB7IHg6ICh3YXJwVmFsc1syXSAqIDIpICogd2lkdGggKyB4LCB5OiAod2FycFZhbHNbM10gKiAtMikgKiBoZWlnaHQgLSB5IH0sCiAgICAgIHsgeDogKHdhcnBWYWxzWzRdICogMikgKiB3aWR0aCArIHgsIHk6ICh3YXJwVmFsc1s1XSAqIC0yKSAqIC1oZWlnaHQgLSB5IH0sCiAgICAgIHsgeDogKHdhcnBWYWxzWzZdICogMikgKiAtd2lkdGggKyB4LCB5OiAod2FycFZhbHNbN10gKiAtMikgKiAtaGVpZ2h0IC0geSB9CiAgICBdOwoKICAgIGNvbnN0IHJvdGF0ZWRQb2ludHMgPSBwb2ludHMubWFwKHAgPT4gcm90YXRlUG9pbnQocC54LCBwLnksIHgsIC15LCBhbmdsZSkpOwogICAgY29uc3QgeHMgPSByb3RhdGVkUG9pbnRzLm1hcChwID0+IHAueCk7CiAgICBjb25zdCB5cyA9IHJvdGF0ZWRQb2ludHMubWFwKHAgPT4gcC55KTsKCiAgICBib3VuZHMubGVmdCA9IE1hdGgubWluKC4uLnhzKTsKICAgIGJvdW5kcy50b3AgPSAtTWF0aC5taW4oLi4ueXMpOwogICAgYm91bmRzLnJpZ2h0ID0gTWF0aC5tYXgoLi4ueHMpOwogICAgYm91bmRzLmJvdHRvbSA9IC1NYXRoLm1heCguLi55cyk7CiAgICByZXR1cm4gYm91bmRzOwogIH0KCiAgY29uc3Qgb2dHZXRCb3VuZHMgPSByZW5kZXIuZXhwb3J0cy5EcmF3YWJsZS5wcm90b3R5cGUuZ2V0Qm91bmRzOwogIHJlbmRlci5leHBvcnRzLkRyYXdhYmxlLnByb3RvdHlwZS5nZXRCb3VuZHMgPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiB3YXJwQm91bmRzKHRoaXMsIG9nR2V0Qm91bmRzLmNhbGwodGhpcykpOwogIH07CiAgY29uc3Qgb2dHZXRBQUJCID0gcmVuZGVyLmV4cG9ydHMuRHJhd2FibGUucHJvdG90eXBlLmdldEFBQkI7CiAgcmVuZGVyLmV4cG9ydHMuRHJhd2FibGUucHJvdG90eXBlLmdldEFBQkIgPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiB3YXJwQm91bmRzKHRoaXMsIG9nR2V0QUFCQi5jYWxsKHRoaXMpKTsKICB9OwoKICAvLyB1cGRhdGUgdGhlIHBlbiBzaGFkZXIKICBpZiAocnVudGltZS5leHRfcGVuICYmIHJ1bnRpbWUuZXh0X3Blbi5fcGVuU2tpbklkID4gLTEpIHsKICAgIGNvbnN0IHBlblNraW4gPSByZW5kZXIuX2FsbFNraW5zW3J1bnRpbWUuZXh0X3Blbi5fcGVuU2tpbklkXTsKICAgIGNvbnN0IGdsID0gcmVuZGVyLmdsOwogICAgcGVuU2tpbi5fbGluZVNoYWRlciA9IHJlbmRlci5fc2hhZGVyTWFuYWdlci5nZXRTaGFkZXIoImxpbmUiLCAwKTsKICAgIHBlblNraW4uX2RyYXdUZXh0dXJlU2hhZGVyID0gcmVuZGVyLl9zaGFkZXJNYW5hZ2VyLmdldFNoYWRlcigiZGVmYXVsdCIsIDApOwogICAgcGVuU2tpbi5hX3Bvc2l0aW9uX2xvYyA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKHBlblNraW4uX2xpbmVTaGFkZXIucHJvZ3JhbSwgImFfcG9zaXRpb24iKTsKICAgIHBlblNraW4uYV9saW5lQ29sb3JfbG9jID0gZ2wuZ2V0QXR0cmliTG9jYXRpb24ocGVuU2tpbi5fbGluZVNoYWRlci5wcm9ncmFtLCAiYV9saW5lQ29sb3IiKTsKICAgIHBlblNraW4uYV9saW5lVGhpY2tuZXNzQW5kTGVuZ3RoX2xvYyA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKHBlblNraW4uX2xpbmVTaGFkZXIucHJvZ3JhbSwgImFfbGluZVRoaWNrbmVzc0FuZExlbmd0aCIpOwogICAgcGVuU2tpbi5hX3BlblBvaW50c19sb2MgPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihwZW5Ta2luLl9saW5lU2hhZGVyLnByb2dyYW0sICJhX3BlblBvaW50cyIpOwogIH0KCiAgLy8gQ2xpcHBpbmcgYW5kIEJsZW5kaW5nIFN1cHBvcnQKICBpZiAodm0uZXh0ZW5zaW9uTWFuYWdlci5fbG9hZGVkRXh0ZW5zaW9ucy5oYXMoInhlbHRhbGxpdmNsaXBibGVuZCIpKSB7CiAgICBjb25zdCBnbCA9IHJlbmRlci5fZ2w7CiAgICAvKiBjb21wcmVzc2VkIGNvZGUgZnJvbSBDbGlwcGluZyBhbmQgQmxlbmRpbmcuanMgKi8KICAgIGNvbnN0IGJmYiA9IGdsLmJpbmRGcmFtZWJ1ZmZlcjsKICAgIGNvbnN0IG9nR2V0VW5pZm9ybXMgPSByZW5kZXIuZXhwb3J0cy5EcmF3YWJsZS5wcm90b3R5cGUuZ2V0VW5pZm9ybXM7CiAgICBnbC5iaW5kRnJhbWVidWZmZXI9ZnVuY3Rpb24oZSxpKXtpZihlPT1nbC5GUkFNRUJVRkZFUil7aWYobnVsbD09aSl0b0NvcnJlY3RUaGluZz0hMCxmbGlwWT0hMSx3aWR0aD1jYW52YXMud2lkdGgsaGVpZ2h0PWNhbnZhcy5oZWlnaHQ7ZWxzZSBpZihyZW5kZXIuX3BlblNraW5JZCl7bGV0IGY9cmVuZGVyLl9hbGxTa2luc1tyZW5kZXIuX3BlblNraW5JZF0uX2ZyYW1lYnVmZmVyO2k9PWYuZnJhbWVidWZmZXI/KHRvQ29ycmVjdFRoaW5nPSEwLGZsaXBZPSEwLHdpZHRoPWYud2lkdGgsaGVpZ2h0PWYuaGVpZ2h0KTp0b0NvcnJlY3RUaGluZz0hMX1lbHNlIHRvQ29ycmVjdFRoaW5nPSExfWJmYi5jYWxsKHRoaXMsZSxpKX07CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUKICAgIGZ1bmN0aW9uIHNldHVwTW9kZXMoZSxuLGEpe2lmKGUpe2dsLmVuYWJsZShnbC5TQ0lTU09SX1RFU1QpO2xldCBFPShlLnhfbWluL3NjcmF0Y2hVbml0V2lkdGgrLjUpKndpZHRofDAsUz0oZS55X21pbi9zY3JhdGNoVW5pdEhlaWdodCsuNSkqaGVpZ2h0fDAsTj0oZS54X21heC9zY3JhdGNoVW5pdFdpZHRoKy41KSp3aWR0aHwwLGIsbD0oKGUueV9tYXgvc2NyYXRjaFVuaXRIZWlnaHQrLjUpKmhlaWdodHwwKS1TO2EmJihTPSgtZS55X21heC9zY3JhdGNoVW5pdEhlaWdodCsuNSkqaGVpZ2h0fDApLGdsLnNjaXNzb3IoRSxTLE4tRSxsKX1lbHNlIGdsLmRpc2FibGUoZ2wuU0NJU1NPUl9URVNUKTtzd2l0Y2gobil7Y2FzZSJhZGRpdGl2ZSI6Z2wuYmxlbmRFcXVhdGlvbihnbC5GVU5DX0FERCksZ2wuYmxlbmRGdW5jKGdsLk9ORSxnbC5PTkUpO2JyZWFrO2Nhc2Uic3VidHJhY3QiOmdsLmJsZW5kRXF1YXRpb24oZ2wuRlVOQ19SRVZFUlNFX1NVQlRSQUNUKSxnbC5ibGVuZEZ1bmMoZ2wuT05FLGdsLk9ORSk7YnJlYWs7Y2FzZSJtdWx0aXBseSI6Z2wuYmxlbmRFcXVhdGlvbihnbC5GVU5DX0FERCksZ2wuYmxlbmRGdW5jKGdsLkRTVF9DT0xPUixnbC5PTkVfTUlOVVNfU1JDX0FMUEhBKTticmVhaztjYXNlImludmVydCI6Z2wuYmxlbmRFcXVhdGlvbihnbC5GVU5DX0FERCksZ2wuYmxlbmRGdW5jKGdsLk9ORV9NSU5VU19EU1RfQ09MT1IsZ2wuT05FX01JTlVTX1NSQ19DT0xPUik7YnJlYWs7ZGVmYXVsdDpnbC5ibGVuZEVxdWF0aW9uKGdsLkZVTkNfQUREKSxnbC5ibGVuZEZ1bmMoZ2wuT05FLGdsLk9ORV9NSU5VU19TUkNfQUxQSEEpfX0KICAgIHJlbmRlci5leHBvcnRzLkRyYXdhYmxlLnByb3RvdHlwZS5nZXRVbmlmb3Jtcz1mdW5jdGlvbigpe3JldHVybiBhY3RpdmUmJnRvQ29ycmVjdFRoaW5nJiZzZXR1cE1vZGVzKHRoaXMuY2xpcGJveCx0aGlzLmJsZW5kTW9kZSxmbGlwWSksb2dHZXRVbmlmb3Jtcy5jYWxsKHRoaXMpfTsKICB9CgogIC8vIHRoaXMgd2lsbCBhbGxvdyBjbG9uZXMgdG8gaW5oZXJpdCBwYXJlbnQgZWZmZWN0cwogIGNvbnN0IG9nSW5pdERyYXdhYmxlID0gdm0uZXhwb3J0cy5SZW5kZXJlZFRhcmdldC5wcm90b3R5cGUuaW5pdERyYXdhYmxlOwogIHZtLmV4cG9ydHMuUmVuZGVyZWRUYXJnZXQucHJvdG90eXBlLmluaXREcmF3YWJsZSA9IGZ1bmN0aW9uKGxheWVyR3JvdXApIHsKICAgIG9nSW5pdERyYXdhYmxlLmNhbGwodGhpcywgbGF5ZXJHcm91cCk7CiAgICBpZiAodGhpcy5pc09yaWdpbmFsKSByZXR1cm47CiAKICAgIGNvbnN0IHBhcmVudFNwcml0ZSA9IHRoaXMuc3ByaXRlLmNsb25lc1swXTsgLy8gY2xvbmVbMF0gaXMgYWx3YXlzIHRoZSBvcmlnaW5hbAogICAgY29uc3QgcGFyZW50RHJhd2FibGUgPSByZW5kZXIuX2FsbERyYXdhYmxlc1twYXJlbnRTcHJpdGUuZHJhd2FibGVJRF07CiAgICBpZiAoIXBhcmVudERyYXdhYmxlW2RyYXdhYmxlS2V5XSkgcmV0dXJuOwoKICAgIGNvbnN0IGRyYXdhYmxlID0gcmVuZGVyLl9hbGxEcmF3YWJsZXNbdGhpcy5kcmF3YWJsZUlEXTsKICAgIGRyYXdhYmxlW2RyYXdhYmxlS2V5XSA9IHN0cnVjdHVyZWRDbG9uZShwYXJlbnREcmF3YWJsZVtkcmF3YWJsZUtleV0pOwogIH07CgogIC8qIHBhdGNoIGZvciAid2hlbiBjb3N0dW1lIHN3aXRjaGVzIiBldmVudCAqLwogIGNvbnN0IG9nU2V0Q29yZUNvc3R1bWUgPSBsb29rc0NvcmUuY29uc3RydWN0b3IucHJvdG90eXBlLl9zZXRDb3N0dW1lOwogIG9nU2V0Q29yZUNvc3R1bWUuY29uc3RydWN0b3IucHJvdG90eXBlLl9zZXRDb3N0dW1lID0gZnVuY3Rpb24gKHRhcmdldCwgcmVxdWVzdGVkQ29zdHVtZSwgb3B0WmVyb0luZGV4KSB7CiAgICBvZ1NldENvcmVDb3N0dW1lLmNhbGwodGhpcywgdGFyZ2V0LCByZXF1ZXN0ZWRDb3N0dW1lLCBvcHRaZXJvSW5kZXgpOwogICAgcnVudGltZS5zdGFydEhhdHMoCiAgICAgICJTUGxvb2tzRXhwYW5kZWRfd2hlbkNvc3R1bWVTd2l0Y2giLAogICAgICB7IENPU1RVTUU6IHRhcmdldC5nZXRDdXJyZW50Q29zdHVtZSgpPy5uYW1lIHx8ICIiIH0KICAgICk7CiAgfTsKICBjb25zdCBvZ1NldFNwcml0ZUNvc3R1bWUgPSB2bS5leHBvcnRzLlJlbmRlcmVkVGFyZ2V0LnByb3RvdHlwZS5zZXRDb3N0dW1lOwogIHZtLmV4cG9ydHMuUmVuZGVyZWRUYXJnZXQucHJvdG90eXBlLnNldENvc3R1bWUgPSBmdW5jdGlvbiAoaW5kZXgpIHsKICAgIG9nU2V0U3ByaXRlQ29zdHVtZS5jYWxsKHRoaXMsIGluZGV4KTsKICAgIHJ1bnRpbWUuc3RhcnRIYXRzKAogICAgICAiU1Bsb29rc0V4cGFuZGVkX3doZW5Db3N0dW1lU3dpdGNoIiwKICAgICAgeyBDT1NUVU1FOiB0aGlzLmdldEN1cnJlbnRDb3N0dW1lKCk/Lm5hbWUgfHwgIiIgfQogICAgKTsKICB9OwoKICBjbGFzcyBTUGxvb2tzRXhwYW5kZWQgewogICAgZ2V0SW5mbygpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBpZDogIlNQbG9va3NFeHBhbmRlZCIsCiAgICAgICAgbmFtZTogU2NyYXRjaC50cmFuc2xhdGUoIkxvb2tzIEV4cGFuZGVkIiksCiAgICAgICAgY29sb3IxOiAiIzk5NjZGRiIsCiAgICAgICAgY29sb3IyOiAiIzg1NUNENiIsCiAgICAgICAgY29sb3IzOiAiIzc3NERDQiIsCiAgICAgICAgbWVudUljb25VUkksCiAgICAgICAgYmxvY2tzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImdldFNwZWVjaCIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuUkVQT1JURVIsCiAgICAgICAgICAgIGV4dGVuc2lvbnM6IFsiY29sb3Vyc19sb29rcyJdLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic3BlZWNoIGZyb20gW1RBUkdFVF0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgVEFSR0VUOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIlRBUkdFVFMiIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgICItLS0iLAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJjb3N0dW1lQ250IiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgZXh0ZW5zaW9uczogWyJjb2xvdXJzX2xvb2tzIl0sCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCIjIG9mIGNvc3R1bWVzIGluIFtUQVJHRVRdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIFRBUkdFVDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJUQVJHRVRTIiB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImNvc3R1bWVJbmZvIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgZXh0ZW5zaW9uczogWyJjb2xvdXJzX2xvb2tzIl0sCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJbSU5GT10gb2YgY29zdHVtZSAjIFtOVU1dIGluIFtUQVJHRVRdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIElORk86IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiQ09TVFVNRV9EQVRBIiB9LAogICAgICAgICAgICAgIE5VTTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsIGRlZmF1bHRWYWx1ZTogMSB9LAogICAgICAgICAgICAgIFRBUkdFVDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJUQVJHRVRTIiB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInNldFRhcmdldENvc3R1bWUiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIGV4dGVuc2lvbnM6IFsiY29sb3Vyc19sb29rcyJdLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic3dpdGNoIGNvc3R1bWUgb2YgW1RBUkdFVF0gdG8gW1ZBTFVFXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBUQVJHRVQ6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiVEFSR0VUUyIgfSwKICAgICAgICAgICAgICBWQUxVRTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogIi4uLiIgfSwKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAid2hlbkNvc3R1bWVTd2l0Y2giLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkVWRU5ULAogICAgICAgICAgICBleHRlbnNpb25zOiBbImNvbG91cnNfZXZlbnQiXSwKICAgICAgICAgICAgaXNFZGdlQWN0aXZhdGVkOiBmYWxzZSwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIndoZW4gY29zdHVtZSBzd2l0Y2hlcyB0byBbQ09TVFVNRV0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgQ09TVFVNRTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJDT1NUVU1FUyIgfSwKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgICItLS0iLAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJzZXRTcHJpdGVFZmZlY3QiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIGV4dGVuc2lvbnM6IFsiY29sb3Vyc19sb29rcyJdLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic2V0IFtFRkZFQ1RdIG9mIFtUQVJHRVRdIHRvIFtWQUxVRV0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgRUZGRUNUOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIkVGRkVDVF9NRU5VIiB9LAogICAgICAgICAgICAgIFRBUkdFVDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJUQVJHRVRTIiB9LAogICAgICAgICAgICAgIFZBTFVFOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLk5VTUJFUiwgZGVmYXVsdFZhbHVlOiAwIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAiZWZmZWN0VmFsdWUiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLAogICAgICAgICAgICBleHRlbnNpb25zOiBbImNvbG91cnNfbG9va3MiXSwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIltFRkZFQ1RdIGVmZmVjdCBvZiBbVEFSR0VUXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBFRkZFQ1Q6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiRUZGRUNUX01FTlUiIH0sCiAgICAgICAgICAgICAgVEFSR0VUOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIlRBUkdFVFMiIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInRpbnRTcHJpdGUiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIGV4dGVuc2lvbnM6IFsiY29sb3Vyc19sb29rcyJdLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic2V0IHRpbnQgb2YgW1RBUkdFVF0gdG8gW0NPTE9SXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBUQVJHRVQ6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiVEFSR0VUUyIgfSwKICAgICAgICAgICAgICBDT0xPUjogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5DT0xPUiB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICAiLS0tIiwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAicmVwbGFjZUNvbG9yIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICBleHRlbnNpb25zOiBbImNvbG91cnNfbG9va3MiXSwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInJlcGxhY2UgW0NPTE9SMV0gd2l0aCBbQ09MT1IyXSBpbiBbVEFSR0VUXSBzb2Z0bmVzcyBbVkFMVUVdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIENPTE9SMTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5DT0xPUiB9LAogICAgICAgICAgICAgIENPTE9SMjogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5DT0xPUiB9LAogICAgICAgICAgICAgIFRBUkdFVDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJUQVJHRVRTIiB9LAogICAgICAgICAgICAgIFZBTFVFOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLk5VTUJFUiwgZGVmYXVsdFZhbHVlOiAxMCB9LAogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJyZXNldENvbG9yIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICBleHRlbnNpb25zOiBbImNvbG91cnNfbG9va3MiXSwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInJlc2V0IFtDT0xPUjFdIHJlcGxhY2VyIGluIFtUQVJHRVRdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIENPTE9SMTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5DT0xPUiB9LAogICAgICAgICAgICAgIFRBUkdFVDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJUQVJHRVRTIiB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInJlc2V0UmVwbGFjZXJzIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICBleHRlbnNpb25zOiBbImNvbG91cnNfbG9va3MiXSwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInJlc2V0IGNvbG9yIHJlcGxhY2VycyBpbiBbVEFSR0VUXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBUQVJHRVQ6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiVEFSR0VUUyIgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlhNTCwKICAgICAgICAgICAgeG1sOiBgPHNlcCBnYXA9IjI0Ii8+PGxhYmVsIHRleHQ9IiR7U2NyYXRjaC50cmFuc2xhdGUoIldhcnBpbmcgYW5kIE1hc2tpbmcgZG9lcyBOT1QiKX0iLz48c2VwIGdhcD0iMCIvPmAsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlhNTCwKICAgICAgICAgICAgeG1sOiBgPHNlcCBnYXA9Ii0xMiIvPjxsYWJlbCB0ZXh0PSIgJHtTY3JhdGNoLnRyYW5zbGF0ZSgiYWZmZWN0IFRvdWNoaW5nIEJsb2NrcyIpfSIvPjxzZXAgZ2FwPSI2Ii8+YCwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogIndhcnBTcHJpdGUiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJ3YXJwIFtUQVJHRVRdIHRvIHgxOiBbeDFdIHkxOiBbeTFdIHgyOiBbeDJdIHkyOiBbeTJdIHgzOiBbeDNdIHkzOiBbeTNdIHg0OiBbeDRdIHk0OiBbeTRdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIFRBUkdFVDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJUQVJHRVRTIiB9LAogICAgICAgICAgICAgIHgxOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLk5VTUJFUiwgZGVmYXVsdFZhbHVlOiAtMTAwIH0sCiAgICAgICAgICAgICAgeTE6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuTlVNQkVSLCBkZWZhdWx0VmFsdWU6IDEwMCB9LAogICAgICAgICAgICAgIHgyOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLk5VTUJFUiwgZGVmYXVsdFZhbHVlOiAxMDAgfSwKICAgICAgICAgICAgICB5MjogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsIGRlZmF1bHRWYWx1ZTogMTAwIH0sCiAgICAgICAgICAgICAgeDM6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuTlVNQkVSLCBkZWZhdWx0VmFsdWU6IC0xMDAgfSwKICAgICAgICAgICAgICB5MzogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsIGRlZmF1bHRWYWx1ZTogLTEwMCB9LAogICAgICAgICAgICAgIHg0OiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLk5VTUJFUiwgZGVmYXVsdFZhbHVlOiAxMDAgfSwKICAgICAgICAgICAgICB5NDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsIGRlZmF1bHRWYWx1ZTogLTEwMCB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJtYXNrU3ByaXRlIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgibWFzayBbVEFSR0VUXSB3aXRoIGltYWdlIFtJTUFHRV0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgVEFSR0VUOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIlRBUkdFVFMiIH0sCiAgICAgICAgICAgICAgSU1BR0U6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBkZWZhdWx0VmFsdWU6ICJodHRwczovL2V4dGVuc2lvbnMudHVyYm93YXJwLm9yZy9kYW5nby5wbmciIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICAiLS0tIiwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAic2hvd1Nwcml0ZSIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInNob3cgW1RBUkdFVF0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgVEFSR0VUOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIlRBUkdFVFMiIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImhpZGVTcHJpdGUiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJoaWRlIFtUQVJHRVRdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIFRBUkdFVDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJUQVJHRVRTIiB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJzcHJpdGVTaG93aW5nIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5CT09MRUFOLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiW1RBUkdFVF0gW1RZUEVdID8iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgVEFSR0VUOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIlRBUkdFVFMiIH0sCiAgICAgICAgICAgICAgVFlQRTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJESVNQTEFZX1RZUEVTIiB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgIi0tLSIsCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInNwcml0ZVByb3BlcnR5IiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIltQUk9QXSBvZiBbVEFSR0VUXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBQUk9QOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIlNQUklURV9QUk9QUyIgfSwKICAgICAgICAgICAgICBUQVJHRVQ6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiVEFSR0VUUyIgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICBdLAogICAgICAgIG1lbnVzOiB7CiAgICAgICAgICBDT1NUVU1FUzogeyBhY2NlcHRSZXBvcnRlcnM6IGZhbHNlLCBpdGVtczogImdldENvc3R1bWVzIiB9LAogICAgICAgICAgVEFSR0VUUzogeyBhY2NlcHRSZXBvcnRlcnM6IHRydWUsIGl0ZW1zOiAiZ2V0VGFyZ2V0cyIgfSwKICAgICAgICAgIEVGRkVDVF9NRU5VOiB7IGFjY2VwdFJlcG9ydGVyczogdHJ1ZSwgaXRlbXM6ICJnZXRFZmZlY3RzIiB9LAogICAgICAgICAgRElTUExBWV9UWVBFUzogewogICAgICAgICAgICBhY2NlcHRSZXBvcnRlcnM6IGZhbHNlLAogICAgICAgICAgICBpdGVtczogWwogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInNob3dpbmciKSwgdmFsdWU6ICJzaG93aW5nIiB9LAogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInZpc2libGUiKSwgdmFsdWU6ICJ2aXNpYmxlIiB9CiAgICAgICAgICAgIF0KICAgICAgICAgIH0sCiAgICAgICAgICBDT1NUVU1FX0RBVEE6IHsKICAgICAgICAgICAgYWNjZXB0UmVwb3J0ZXJzOiB0cnVlLAogICAgICAgICAgICBpdGVtczogWwogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIm5hbWUiKSwgdmFsdWU6ICJuYW1lIiB9LAogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInR5cGUiKSwgdmFsdWU6ICJ0eXBlIiB9LAogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIndpZHRoIiksIHZhbHVlOiAid2lkdGgiIH0sCiAgICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiaGVpZ2h0IiksIHZhbHVlOiAiaGVpZ2h0IiB9LAogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInJvdGF0aW9uIGNlbnRlciB4IiksIHZhbHVlOiAicm90YXRpb24gY2VudGVyIHgiIH0sCiAgICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgicm90YXRpb24gY2VudGVyIHkiKSwgdmFsdWU6ICJyb3RhdGlvbiBjZW50ZXIgeSIgfSwKICAgICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJjb250ZW50IiksIHZhbHVlOiAiY29udGVudCIgfSwKICAgICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJkYXRhLnVyaSIpLCB2YWx1ZTogImRhdGEudXJpIiB9CiAgICAgICAgICAgIF0KICAgICAgICAgIH0sCiAgICAgICAgICBTUFJJVEVfUFJPUFM6IHsKICAgICAgICAgICAgYWNjZXB0UmVwb3J0ZXJzOiB0cnVlLAogICAgICAgICAgICBpdGVtczogWwogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIndpZHRoIiksIHZhbHVlOiAid2lkdGgiIH0sCiAgICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiaGVpZ2h0IiksIHZhbHVlOiAiaGVpZ2h0IiB9LAogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImxheWVyICMiKSwgdmFsdWU6ICJsYXllciAjIiB9CiAgICAgICAgICAgIF0KICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgfTsKICAgIH0KCiAgICAvLyBIZWxwZXIgRnVuY3MKICAgIGdldFRhcmdldHMoKSB7CiAgICAgIGNvbnN0IHNwcml0ZU5hbWVzID0gWwogICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIm15c2VsZiIpLCB2YWx1ZTogIl9teXNlbGZfIiB9LAogICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIlN0YWdlIiksIHZhbHVlOiAiX3N0YWdlXyIgfQogICAgICBdOwogICAgICBjb25zdCB0YXJnZXRzID0gcnVudGltZS50YXJnZXRzOwogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHRhcmdldHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB0YXJnZXQgPSB0YXJnZXRzW2ldOwogICAgICAgIGlmICh0YXJnZXQuaXNPcmlnaW5hbCkgc3ByaXRlTmFtZXMucHVzaCh7IHRleHQ6IHRhcmdldC5nZXROYW1lKCksIHZhbHVlOiB0YXJnZXQuZ2V0TmFtZSgpIH0pOwogICAgICB9CiAgICAgIHJldHVybiBzcHJpdGVOYW1lcy5sZW5ndGggPiAwID8gc3ByaXRlTmFtZXMgOiBbIiJdOwogICAgfQoKICAgIGdldENvc3R1bWVzKCkgewogICAgICBsZXQgY29zdHVtZU5hbWVzID0gW107CiAgICAgIGlmICh2bS5lZGl0aW5nVGFyZ2V0KSBjb3N0dW1lTmFtZXMgPSB2bS5lZGl0aW5nVGFyZ2V0LmdldENvc3R1bWVzKCkubWFwKChlKSA9PiB7IHJldHVybiBlLm5hbWUgfSk7CiAgICAgIHJldHVybiBjb3N0dW1lTmFtZXMubGVuZ3RoID4gMCA/IGNvc3R1bWVOYW1lcyA6IFsiIl07CiAgICB9CgogICAgZ2V0RWZmZWN0cygpIHsKICAgICAgY29uc3QgZWZmZWN0cyA9IE9iamVjdC5rZXlzKHZtLmVkaXRpbmdUYXJnZXQ/LmVmZmVjdHMgfHwge30pOwogICAgICBpZiAoIWlzUE0pIGVmZmVjdHMucHVzaCgic2F0dXJhdGlvbiIsICJvcGFxdWUiKTsKICAgICAgZWZmZWN0cy5wdXNoKCJjb250cmFzdCIsICJwb3N0ZXJpemUiLCAic2VwaWEiLCAiYmxvb20iKTsKICAgICAgZWZmZWN0cy5tYXAoKGVmZmVjdCkgPT4gewogICAgICAgIHJldHVybiB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKGVmZmVjdCksIHZhbHVlOiBlZmZlY3QgfTsKICAgICAgfSk7CiAgICAgIHJldHVybiBlZmZlY3RzLmxlbmd0aCA+IDAgPyBlZmZlY3RzIDogWyIiXTsKICAgIH0KCiAgICBnZXRUYXJnZXQobmFtZSwgdXRpbCkgewogICAgICBpZiAobmFtZSA9PT0gIl9teXNlbGZfIikgcmV0dXJuIHV0aWwudGFyZ2V0OwogICAgICBpZiAobmFtZSA9PT0gIl9zdGFnZV8iKSByZXR1cm4gcnVudGltZS5nZXRUYXJnZXRGb3JTdGFnZSgpOwogICAgICByZXR1cm4gcnVudGltZS5nZXRTcHJpdGVUYXJnZXRCeU5hbWUobmFtZSk7CiAgICB9CgogICAgZXhwb3J0Q29zdHVtZShjb3N0dW1lLCBrZWVwQmFzZTY0KSB7CiAgICAgIGNvbnN0IGFzc2V0ID0gY29zdHVtZS5hc3NldDsKICAgICAgaWYgKHJ1bnRpbWUuaXNQYWNrYWdlZCkgewogICAgICAgIGNvbnN0IHNraW4gPSByZW5kZXIuX2FsbFNraW5zW2Nvc3R1bWUuc2tpbklkXTsKICAgICAgICBsZXQgdHlwZSA9IGNvc3R1bWUuZGF0YUZvcm1hdDsKICAgICAgICBpZiAodHlwZSA9PT0gInN2ZyIpIHsKICAgICAgICAgIGNvbnN0IHN2Z1RleHQgPSBkZWNvZGVVUklDb21wb25lbnQoc2tpbi5fc3ZnSW1hZ2Uuc3JjLnNwbGl0KCIsIilbMV0pOwogICAgICAgICAgaWYgKGtlZXBCYXNlNjQpIHJldHVybiBgZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCwke2J0b2Eoc3ZnVGV4dCl9YDsKICAgICAgICAgIGVsc2UgcmV0dXJuIHN2Z1RleHQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIGFsd2F5cyByZXR1cm4gYmFzZSA2NCwgdGhlcmVzIGxpdGVyYWxseSBubyBwb2ludAogICAgICAgICAgY29uc3QgZ2wgPSByZW5kZXIuZ2w7CiAgICAgICAgICBjb25zdCB3aWR0aCA9IHNraW4uc2l6ZVswXSAqIDI7CiAgICAgICAgICBjb25zdCBoZWlnaHQgPSBza2luLnNpemVbMV0gKiAyOwoKICAgICAgICAgIGNvbnN0IGZibyA9IHR3Z2wuY3JlYXRlRnJhbWVidWZmZXJJbmZvKAogICAgICAgICAgICBnbCwgW3sgYXR0YWNobWVudDogc2tpbi5fdGV4dHVyZSB9XSwKICAgICAgICAgICAgd2lkdGgsIGhlaWdodAogICAgICAgICAgKTsKICAgICAgICAgIHR3Z2wuYmluZEZyYW1lYnVmZmVySW5mbyhnbCwgZmJvKTsKICAgICAgICAgIGNvbnN0IHBpeGVscyA9IG5ldyBVaW50OEFycmF5KHdpZHRoICogaGVpZ2h0ICogNCk7CiAgICAgICAgICBnbC5yZWFkUGl4ZWxzKDAsIDAsIHdpZHRoLCBoZWlnaHQsIGdsLlJHQkEsIGdsLlVOU0lHTkVEX0JZVEUsIHBpeGVscyk7CgogICAgICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7CiAgICAgICAgICBjYW52YXMud2lkdGggPSB3aWR0aDsgY2FudmFzLmhlaWdodCA9IGhlaWdodDsKICAgICAgICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwogICAgICAgICAgY29uc3QgaW1hZ2VEYXRhID0gY3R4LmNyZWF0ZUltYWdlRGF0YSh3aWR0aCwgaGVpZ2h0KTsKICAgICAgICAgIGltYWdlRGF0YS5kYXRhLnNldChwaXhlbHMpOwogICAgICAgICAgY3R4LnB1dEltYWdlRGF0YShpbWFnZURhdGEsIDAsIDApOwogICAgICAgICAgcmV0dXJuIGNhbnZhcy50b0RhdGFVUkwoImltYWdlL3BuZyIpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoa2VlcEJhc2U2NCkgcmV0dXJuIGFzc2V0LmVuY29kZURhdGFVUkkoKTsKICAgICAgICBlbHNlIHJldHVybiBhc3NldC5kZWNvZGVUZXh0KCk7CiAgICAgIH0KICAgIH0KCiAgICBoZXgyVmVjNChoZXgpIHsKICAgICAgaGV4ID0gaGV4LnN0YXJ0c1dpdGgoIiMiKSA/IGhleC5zbGljZSgxKSA6IGhleDsKICAgICAgbGV0IGEgPSAyNTU7CiAgICAgIGlmIChoZXgubGVuZ3RoID09PSA4KSBhID0gcGFyc2VJbnQoaGV4LnNsaWNlKDYsIDgpLCAxNik7CiAgICAgIHJldHVybiBbCiAgICAgICAgcGFyc2VJbnQoaGV4LnNsaWNlKDAsIDIpLCAxNikgLyAyNTUsCiAgICAgICAgcGFyc2VJbnQoaGV4LnNsaWNlKDIsIDQpLCAxNikgLyAyNTUsCiAgICAgICAgcGFyc2VJbnQoaGV4LnNsaWNlKDQsIDYpLCAxNikgLyAyNTUsCiAgICAgICAgYSAvIDI1NQogICAgICBdOwogICAgfQoKICAgIGFycmF5TWF0Y2hlcyhhcnIxLCBhcnIyKSB7CiAgICAgIHJldHVybiBhcnIxLmV2ZXJ5KCh2YWwsIGkpID0+IHZhbCA9PT0gYXJyMltpXSk7CiAgICB9CgogICAgLy8gQmxvY2sgRnVuY3MKICAgIGdldFNwZWVjaChhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZ2V0VGFyZ2V0KGFyZ3MuVEFSR0VULCB1dGlsKTsKICAgICAgaWYgKCF0YXJnZXQpIHJldHVybiAiIjsKICAgICAgcmV0dXJuIHRhcmdldC5fY3VzdG9tU3RhdGVbIlNjcmF0Y2gubG9va3MiXT8udGV4dCB8fCAiIjsKICAgIH0KCiAgICBjb3N0dW1lQ250KGFyZ3MsIHV0aWwpIHsKICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5nZXRUYXJnZXQoYXJncy5UQVJHRVQsIHV0aWwpOwogICAgICBpZiAoIXRhcmdldCkgcmV0dXJuIDA7CiAgICAgIHJldHVybiB0YXJnZXQuc3ByaXRlLmNvc3R1bWVzLmxlbmd0aDsKICAgIH0KCiAgICBjb3N0dW1lSW5mbyhhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZ2V0VGFyZ2V0KGFyZ3MuVEFSR0VULCB1dGlsKTsKICAgICAgaWYgKCF0YXJnZXQpIHJldHVybiAiIjsKCiAgICAgIGNvbnN0IGNvc3R1bWVzID0gdGFyZ2V0LmdldENvc3R1bWVzKCk7CiAgICAgIGNvbnN0IGluZGV4ID0gQ2FzdC50b051bWJlcihhcmdzLk5VTSkgLSAxOwogICAgICBjb25zdCBjb3N0dW1lID0gY29zdHVtZXNbaW5kZXhdOwogICAgICBpZiAoIWNvc3R1bWUpIHJldHVybiAiIjsKCiAgICAgIHN3aXRjaCAoYXJncy5JTkZPKSB7CiAgICAgICAgY2FzZSAibmFtZSI6IHJldHVybiBjb3N0dW1lLm5hbWU7CiAgICAgICAgY2FzZSAid2lkdGgiOiByZXR1cm4gY29zdHVtZS5zaXplWzBdOwogICAgICAgIGNhc2UgImhlaWdodCI6IHJldHVybiBjb3N0dW1lLnNpemVbMV07CiAgICAgICAgY2FzZSAidHlwZSI6IHJldHVybiBjb3N0dW1lLmRhdGFGb3JtYXQ7CiAgICAgICAgY2FzZSAicm90YXRpb24gY2VudGVyIHgiOiByZXR1cm4gY29zdHVtZS5yb3RhdGlvbkNlbnRlclg7CiAgICAgICAgY2FzZSAicm90YXRpb24gY2VudGVyIHkiOiByZXR1cm4gY29zdHVtZS5yb3RhdGlvbkNlbnRlclk7CiAgICAgICAgY2FzZSAiY29udGVudCI6IHJldHVybiB0aGlzLmV4cG9ydENvc3R1bWUoY29zdHVtZSwgZmFsc2UpOwogICAgICAgIGNhc2UgImRhdGEudXJpIjogcmV0dXJuIHRoaXMuZXhwb3J0Q29zdHVtZShjb3N0dW1lLCB0cnVlKTsKICAgICAgICBkZWZhdWx0OiByZXR1cm4gIiI7CiAgICAgIH0KICAgIH0KCiAgICBzZXRUYXJnZXRDb3N0dW1lKGFyZ3MsIHV0aWwpIHsKICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5nZXRUYXJnZXQoYXJncy5UQVJHRVQsIHV0aWwpOwogICAgICBpZiAodGFyZ2V0KSB7CiAgICAgICAgaWYgKHRhcmdldC5pc1N0YWdlKSBydW50aW1lLmV4dF9zY3JhdGNoM19sb29rcy5fc2V0QmFja2Ryb3AodGFyZ2V0LCBhcmdzLlZBTFVFKTsKICAgICAgICBlbHNlIHJ1bnRpbWUuZXh0X3NjcmF0Y2gzX2xvb2tzLl9zZXRDb3N0dW1lKHRhcmdldCwgYXJncy5WQUxVRSk7CiAgICAgIH0KICAgIH0KCiAgICBzZXRTcHJpdGVFZmZlY3QoYXJncywgdXRpbCkgewogICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLmdldFRhcmdldChhcmdzLlRBUkdFVCwgdXRpbCk7CiAgICAgIGlmICh0YXJnZXQpIHsKICAgICAgICBjb25zdCBuYW1lID0gQ2FzdC50b1N0cmluZyhhcmdzLkVGRkVDVCk7CiAgICAgICAgbGV0IHZhbHVlID0gQ2FzdC50b051bWJlcihhcmdzLlZBTFVFKTsKICAgICAgICBpZiAobmFtZSAhPT0gInBvc3Rlcml6ZSIpIHZhbHVlIC89IDEwMDsKICAgICAgICBpZiAoCiAgICAgICAgICBuYW1lID09PSAiY29udHJhc3QiIHx8IG5hbWUgPT09ICJwb3N0ZXJpemUiIHx8CiAgICAgICAgICBuYW1lID09PSAic2VwaWEiIHx8IG5hbWUgPT09ICJibG9vbSIgfHwKICAgICAgICAgICghaXNQTSAmJiAobmFtZSA9PT0gInNhdHVyYXRpb24iIHx8IG5hbWUgPT09ICJvcGFxdWUiKSkKICAgICAgICApIHsKICAgICAgICAgIGNvbnN0IGRyYXdhYmxlID0gcmVuZGVyLl9hbGxEcmF3YWJsZXNbdGFyZ2V0LmRyYXdhYmxlSURdOwogICAgICAgICAgaW5pdERyYXdhYmxlKGRyYXdhYmxlKTsKICAgICAgICAgIGNvbnN0IG9sZFZhbHVlID0gZHJhd2FibGVbZHJhd2FibGVLZXldLm5ld0VmZmVjdHNbbmFtZV07CiAgICAgICAgICBkcmF3YWJsZVtkcmF3YWJsZUtleV0ubmV3RWZmZWN0c1tuYW1lXSA9IHZhbHVlCiAgICAgICAgICBpZiAob2xkVmFsdWUgIT09IHZhbHVlKSByZW5kZXIuZGlydHkgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0YXJnZXQuc2V0RWZmZWN0KG5hbWUsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBlZmZlY3RWYWx1ZShhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZ2V0VGFyZ2V0KGFyZ3MuVEFSR0VULCB1dGlsKTsKICAgICAgaWYgKCF0YXJnZXQpIHJldHVybiAwOwoKICAgICAgY29uc3QgZWZmZWN0cyA9IHRhcmdldC5lZmZlY3RzOwogICAgICBjb25zdCBuYW1lID0gQ2FzdC50b1N0cmluZyhhcmdzLkVGRkVDVCk7CiAgICAgIGlmICgKICAgICAgICBuYW1lID09PSAiY29udHJhc3QiIHx8IG5hbWUgPT09ICJwb3N0ZXJpemUiIHx8CiAgICAgICAgbmFtZSA9PT0gInNlcGlhIiB8fCBuYW1lID09PSAiYmxvb20iIHx8CiAgICAgICAgKCFpc1BNICYmIChuYW1lID09PSAic2F0dXJhdGlvbiIgfHwgbmFtZSA9PT0gIm9wYXF1ZSIpKQogICAgICApIHsKICAgICAgICBjb25zdCBkcmF3YWJsZSA9IHJlbmRlci5fYWxsRHJhd2FibGVzW3RhcmdldC5kcmF3YWJsZUlEXTsKICAgICAgICBpbml0RHJhd2FibGUoZHJhd2FibGUpOwogICAgICAgIGNvbnN0IHZhbHVlID0gZHJhd2FibGVbZHJhd2FibGVLZXldLm5ld0VmZmVjdHNbbmFtZV07CiAgICAgICAgcmV0dXJuIG5hbWUgPT09ICJwb3N0ZXJpemUiID8gdmFsdWUgOiB2YWx1ZSAqIDEwMDsKICAgICAgfQogICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGVmZmVjdHMsIG5hbWUpKSByZXR1cm4gZWZmZWN0c1tuYW1lXTsKICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgdGludFNwcml0ZShhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZ2V0VGFyZ2V0KGFyZ3MuVEFSR0VULCB1dGlsKTsKICAgICAgaWYgKCF0YXJnZXQpIHJldHVybjsKCiAgICAgIGNvbnN0IGRyYXdhYmxlID0gcmVuZGVyLl9hbGxEcmF3YWJsZXNbdGFyZ2V0LmRyYXdhYmxlSURdOwogICAgICBpbml0RHJhd2FibGUoZHJhd2FibGUpOwogICAgICBjb25zdCBvbGRUaW50ID0gZHJhd2FibGVbZHJhd2FibGVLZXldLnRpbnQ7CiAgICAgIGRyYXdhYmxlW2RyYXdhYmxlS2V5XS50aW50ID0gdGhpcy5oZXgyVmVjNChhcmdzLkNPTE9SKTsKICAgICAgaWYgKCF0aGlzLmFycmF5TWF0Y2hlcyhvbGRUaW50LCBkcmF3YWJsZVtkcmF3YWJsZUtleV0udGludCkpIHJlbmRlci5kaXJ0eSA9IHRydWU7CiAgICB9CgogICAgcmVwbGFjZUNvbG9yKGFyZ3MsIHV0aWwpIHsKICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5nZXRUYXJnZXQoYXJncy5UQVJHRVQsIHV0aWwpOwogICAgICBpZiAoIXRhcmdldCkgcmV0dXJuOwoKICAgICAgdGhpcy5yZXNldENvbG9yKGFyZ3MsIHV0aWwpOwogICAgICBjb25zdCBkcmF3YWJsZSA9IHJlbmRlci5fYWxsRHJhd2FibGVzW3RhcmdldC5kcmF3YWJsZUlEXTsKICAgICAgaW5pdERyYXdhYmxlKGRyYXdhYmxlKTsKICAgICAgZHJhd2FibGVbZHJhd2FibGVLZXldLnJlcGxhY2Vycy5wdXNoKHsKICAgICAgICB0YXJnZXRIZXg6IGFyZ3MuQ09MT1IxLAogICAgICAgIHRhcmdldFZlcnQ6IHRoaXMuaGV4MlZlYzQoYXJncy5DT0xPUjEpLAogICAgICAgIHJlcGxhY2VWZXJ0OiB0aGlzLmhleDJWZWM0KGFyZ3MuQ09MT1IyKSwKICAgICAgICBzb2Z0OiBNYXRoLm1heChDYXN0LnRvTnVtYmVyKGFyZ3MuVkFMVUUpLCAxKSAvIDEwMAogICAgICB9KTsKICAgICAgcmVuZGVyLmRpcnR5ID0gdHJ1ZTsKICAgIH0KCiAgICByZXNldENvbG9yKGFyZ3MsIHV0aWwpIHsKICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5nZXRUYXJnZXQoYXJncy5UQVJHRVQsIHV0aWwpOwogICAgICBpZiAoIXRhcmdldCkgcmV0dXJuOwoKICAgICAgY29uc3QgZHJhd2FibGUgPSByZW5kZXIuX2FsbERyYXdhYmxlc1t0YXJnZXQuZHJhd2FibGVJRF07CiAgICAgIGluaXREcmF3YWJsZShkcmF3YWJsZSk7CiAgICAgIGNvbnN0IGluZGV4ID0gZHJhd2FibGVbZHJhd2FibGVLZXldLnJlcGxhY2Vycy5maW5kSW5kZXgoKGkpID0+IHsgcmV0dXJuIGkudGFyZ2V0SGV4ID09PSBhcmdzLkNPTE9SMSB9KTsKICAgICAgaWYgKGluZGV4ID4gLTEpIGRyYXdhYmxlW2RyYXdhYmxlS2V5XS5yZXBsYWNlcnMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgcmVuZGVyLmRpcnR5ID0gdHJ1ZTsKICAgIH0KCiAgICByZXNldFJlcGxhY2VycyhhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZ2V0VGFyZ2V0KGFyZ3MuVEFSR0VULCB1dGlsKTsKICAgICAgaWYgKCF0YXJnZXQpIHJldHVybjsKCiAgICAgIGNvbnN0IGRyYXdhYmxlID0gcmVuZGVyLl9hbGxEcmF3YWJsZXNbdGFyZ2V0LmRyYXdhYmxlSURdOwogICAgICBpbml0RHJhd2FibGUoZHJhd2FibGUpOwogICAgICBpZiAoZHJhd2FibGVbZHJhd2FibGVLZXldLnJlcGxhY2Vycy5sZW5ndGggPiAwKSB7CiAgICAgICAgZHJhd2FibGVbZHJhd2FibGVLZXldLnJlcGxhY2VycyA9IFtdOwogICAgICAgIHJlbmRlci5kaXJ0eSA9IHRydWU7CiAgICAgIH0KICAgIH0KCiAgICB3YXJwU3ByaXRlKGFyZ3MsIHV0aWwpIHsKICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5nZXRUYXJnZXQoYXJncy5UQVJHRVQsIHV0aWwpOwogICAgICBpZiAoIXRhcmdldCkgcmV0dXJuOwoKICAgICAgY29uc3QgZHJhd2FibGUgPSByZW5kZXIuX2FsbERyYXdhYmxlc1t0YXJnZXQuZHJhd2FibGVJRF07CiAgICAgIGluaXREcmF3YWJsZShkcmF3YWJsZSk7CiAgICAgIGNvbnN0IG9sZFdhcnAgPSBkcmF3YWJsZVtkcmF3YWJsZUtleV0ud2FycDsKICAgICAgZHJhd2FibGVbZHJhd2FibGVLZXldLndhcnAgPSBbCiAgICAgICAgQ2FzdC50b051bWJlcihhcmdzLngxKSAvIC0yMDAsIENhc3QudG9OdW1iZXIoYXJncy55MSkgLyAtMjAwLAogICAgICAgIENhc3QudG9OdW1iZXIoYXJncy54MikgLyAtMjAwLCBDYXN0LnRvTnVtYmVyKGFyZ3MueTIpIC8gLTIwMCwKICAgICAgICBDYXN0LnRvTnVtYmVyKGFyZ3MueDQpIC8gLTIwMCwgQ2FzdC50b051bWJlcihhcmdzLnk0KSAvIC0yMDAsCiAgICAgICAgQ2FzdC50b051bWJlcihhcmdzLngzKSAvIC0yMDAsIENhc3QudG9OdW1iZXIoYXJncy55MykgLyAtMjAwCiAgICAgIF07CiAgICAgIGlmICghdGhpcy5hcnJheU1hdGNoZXMob2xkV2FycCwgZHJhd2FibGVbZHJhd2FibGVLZXldLndhcnApKSByZW5kZXIuZGlydHkgPSB0cnVlOwogICAgfQoKICAgIG1hc2tTcHJpdGUoYXJncywgdXRpbCkgewogICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLmdldFRhcmdldChhcmdzLlRBUkdFVCwgdXRpbCk7CiAgICAgIGlmICghdGFyZ2V0KSByZXR1cm47CgogICAgICBjb25zdCBkcmF3YWJsZSA9IHJlbmRlci5fYWxsRHJhd2FibGVzW3RhcmdldC5kcmF3YWJsZUlEXTsKICAgICAgaW5pdERyYXdhYmxlKGRyYXdhYmxlKTsKCiAgICAgIGNvbnN0IHVybCA9IENhc3QudG9TdHJpbmcoYXJncy5JTUFHRSk7CiAgICAgIGlmIChkcmF3YWJsZVtkcmF3YWJsZUtleV0ub2xkTWFzayA9PT0gdXJsKSByZXR1cm47CiAgICAgIGlmICghdXJsIHx8ICEodXJsLnN0YXJ0c1dpdGgoImRhdGE6aW1hZ2UvIikgfHwgdXJsLnN0YXJ0c1dpdGgoImh0dHBzOi8vIikpKSB7CiAgICAgICAgZHJhd2FibGVbZHJhd2FibGVLZXldLm1hc2tUZXh0dXJlID0gIiI7CiAgICAgICAgZHJhd2FibGVbZHJhd2FibGVLZXldLm9sZE1hc2sgPSAiIjsKICAgICAgICBkcmF3YWJsZVtkcmF3YWJsZUtleV0uc2hvdWxkTWFzayA9IDA7CiAgICAgICAgcmVuZGVyLmRpcnR5ID0gdHJ1ZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgY29uc3QgZ2wgPSByZW5kZXIuX2dsOwogICAgICAgIGlmICghZHJhd2FibGVbZHJhd2FibGVLZXldLl9tYXNrVGV4dHVyZSkgewogICAgICAgICAgZHJhd2FibGVbZHJhd2FibGVLZXldLl9tYXNrVGV4dHVyZSA9IGdsLmNyZWF0ZVRleHR1cmUoKTsKICAgICAgICAgIGdsLmJpbmRUZXh0dXJlKGdsLlRFWFRVUkVfMkQsIGRyYXdhYmxlW2RyYXdhYmxlS2V5XS5fbWFza1RleHR1cmUpOwoKICAgICAgICAgIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9NSU5fRklMVEVSLCBnbC5ORUFSRVNUKTsKICAgICAgICAgIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9NQUdfRklMVEVSLCBnbC5ORUFSRVNUKTsKICAgICAgICAgIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9XUkFQX1MsIGdsLkNMQU1QX1RPX0VER0UpOwogICAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX1dSQVBfVCwgZ2wuQ0xBTVBfVE9fRURHRSk7CiAgICAgICAgfQoKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUKICAgICAgICBjb25zdCBpbWFnZSA9IG5ldyBJbWFnZSgpOwogICAgICAgIGltYWdlLmNyb3NzT3JpZ2luID0gIkFub255bW91cyI7CiAgICAgICAgaW1hZ2Uub25sb2FkID0gKCkgPT4gewogICAgICAgICAgZ2wuYmluZFRleHR1cmUoZ2wuVEVYVFVSRV8yRCwgZHJhd2FibGVbZHJhd2FibGVLZXldLl9tYXNrVGV4dHVyZSk7CiAgICAgICAgICBnbC50ZXhJbWFnZTJEKGdsLlRFWFRVUkVfMkQsIDAsIGdsLlJHQkEsIGdsLlJHQkEsIGdsLlVOU0lHTkVEX0JZVEUsIGltYWdlKTsKCiAgICAgICAgICBkcmF3YWJsZVtkcmF3YWJsZUtleV0ubWFza1RleHR1cmUgPSBkcmF3YWJsZVtkcmF3YWJsZUtleV0uX21hc2tUZXh0dXJlOwogICAgICAgICAgZHJhd2FibGVbZHJhd2FibGVLZXldLnNob3VsZE1hc2sgPSAxOwogICAgICAgICAgZHJhd2FibGVbZHJhd2FibGVLZXldLm9sZE1hc2sgPSB1cmw7CiAgICAgICAgICByZW5kZXIuZGlydHkgPSB0cnVlOwogICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgIH07CiAgICAgICAgaW1hZ2Uub25lcnJvciA9IChlKSA9PiB7CiAgICAgICAgICBjb25zb2xlLndhcm4oZSk7CiAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgfTsKICAgICAgICBpbWFnZS5zcmMgPSB1cmw7CiAgICAgIH0pOwogICAgfQoKICAgIHNob3dTcHJpdGUoYXJncywgdXRpbCkgewogICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLmdldFRhcmdldChhcmdzLlRBUkdFVCwgdXRpbCk7CiAgICAgIGlmICh0YXJnZXQpIHRhcmdldC5zZXRWaXNpYmxlKHRydWUpOwogICAgfQoKICAgIGhpZGVTcHJpdGUoYXJncywgdXRpbCkgewogICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLmdldFRhcmdldChhcmdzLlRBUkdFVCwgdXRpbCk7CiAgICAgIGlmICh0YXJnZXQpIHRhcmdldC5zZXRWaXNpYmxlKGZhbHNlKTsKICAgIH0KCiAgICBzcHJpdGVTaG93aW5nKGFyZ3MsIHV0aWwpIHsKICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5nZXRUYXJnZXQoYXJncy5UQVJHRVQsIHV0aWwpOwogICAgICBpZiAoIXRhcmdldCB8fCAhdGFyZ2V0LnZpc2libGUpIHJldHVybiBmYWxzZTsKICAgICAgaWYgKGFyZ3MuVFlQRSA9PT0gInNob3dpbmciKSByZXR1cm4gdHJ1ZTsKICAgICAgZWxzZSB7CiAgICAgICAgLy8gY2hlY2sgaWYgc3ByaXRlIGlzIHZpc2libGUKICAgICAgICBpZiAodGFyZ2V0LmVmZmVjdHMuZ2hvc3QgPT09IDEwMCkgcmV0dXJuIGZhbHNlOwoKICAgICAgICAvLyBjaGVjayBpZiBzcHJpdGUgaXMgb24tc2NyZWVuCiAgICAgICAgY29uc3QgYm91bmRzID0gdGFyZ2V0LmdldEJvdW5kcygpOwogICAgICAgIGlmIChib3VuZHMubGVmdCA+IHJ1bnRpbWUuc3RhZ2VXaWR0aCAvIDIgfHwgYm91bmRzLnJpZ2h0IDwgcnVudGltZS5zdGFnZVdpZHRoIC8gLTIpIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAoYm91bmRzLmJvdHRvbSA+IHJ1bnRpbWUuc3RhZ2VIZWlnaHQgLyAyIHx8IGJvdW5kcy50b3AgPCBydW50aW1lLnN0YWdlSGVpZ2h0IC8gLTIpIHJldHVybiBmYWxzZTsKCiAgICAgICAgLy8gY2hlY2sgaWYgc3ByaXRlIGlzIGJlaW5nIGNvdmVyZWQKICAgICAgICBjb25zdCBsYXllckluZCA9IHRhcmdldC5nZXRMYXllck9yZGVyKCkgKyAxOwogICAgICAgIGNvbnN0IHJhbmdlSWRzID0gbmV3IEFycmF5KHJlbmRlci5fYWxsRHJhd2FibGVzLmxlbmd0aCAtIGxheWVySW5kKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJhbmdlSWRzLmxlbmd0aDsgaSsrKSB7IHJhbmdlSWRzW2ldID0gbGF5ZXJJbmQgKyBpIH0KICAgICAgICByZXR1cm4gIXJlbmRlci5pc1RvdWNoaW5nRHJhd2FibGVzKHRhcmdldC5kcmF3YWJsZUlELCByYW5nZUlkcyk7CiAgICAgIH0KICAgIH0KCiAgICBzcHJpdGVQcm9wZXJ0eShhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZ2V0VGFyZ2V0KGFyZ3MuVEFSR0VULCB1dGlsKTsKICAgICAgc3dpdGNoIChhcmdzLlBST1ApIHsKICAgICAgICBjYXNlICJ3aWR0aCI6IHJldHVybiB0YXJnZXQuZ2V0Qm91bmRzKCkud2lkdGg7CiAgICAgICAgY2FzZSAiaGVpZ2h0IjogcmV0dXJuIHRhcmdldC5nZXRCb3VuZHMoKS5oZWlnaHQ7CiAgICAgICAgY2FzZSAibGF5ZXIgIyI6IHJldHVybiB0YXJnZXQuZ2V0TGF5ZXJPcmRlcigpOwogICAgICAgIGRlZmF1bHQ6IHJldHVybiAiIjsKICAgICAgfQogICAgfQogIH0KCiAgU2NyYXRjaC5leHRlbnNpb25zLnJlZ2lzdGVyKG5ldyBTUGxvb2tzRXhwYW5kZWQoKSk7Cn0pKFNjcmF0Y2gpOwo=","runtimeoptions":"https://extensions.turbowarp.org/runtime-options.js","files":"https://extensions.turbowarp.org/files.js","lmsLooksPlus":"https://extensions.turbowarp.org/Lily/LooksPlus.js"},"customFonts":[{"system":false,"family":"Bauhaus 93","fallback":"Marker","md5ext":"191734283bbd6d5733e73020039923d4.ttf"}],"meta":{"semver":"3.0.0","platform":{"name":"TurboWarp","url":"https://turbowarp.org/"}}}